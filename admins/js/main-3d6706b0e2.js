!function e(t,n,i){function a(s,u){if(!n[s]){if(!t[s]){var r="function"==typeof require&&require;if(!u&&r)return r(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return a(n?n:e)},d,d.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){function i(t,n,i){var a,o=e("./template.js"),s=(e("../util/load.js")(),function(){}),u=function(e){var n=doT.template(o.listItem)(e),i=$(n);$(t).find(".js-users-list").append(i)},r=function(e,t){switch(t.type){case 102:u(t)}},d=function(e,i){a=n.getGlobal(),$(t).find("img.js-my-logo").attr("src",i.face),$(t).find(".js-customer-service").html(i.name)},l=function(){$(document.body).on("core.onload",d),$(document.body).on("core.receive",r)},c=function(){},f=function(){s(),l(),c()};f()}t.exports=i},{"../util/load.js":41,"./template.js":2}],2:[function(e,t,n){var i={};i.listItem='<li title="{{=it.uname}}" ><a href="javascript:;" class="user"  name="{{=it.uname}}" usource="0" data-uid="c8502966db3f40538794a4e9ab9a8c49"><i class="fa fa-laptop"><span class="newIcon"></span></i><span class="uname" style="width: 230px;">{{=it.uname}}</span><span class="lastMsg"><span style="color:#ffad01">sfsad</span></span><span class="badge badge-red msg-count"></span><i class="user-del"  style="display: none;"><span class="newIcon"></span></i><span class="ohide">{{=it.uname}}</span></a></li>',t.exports=i},{}],3:[function(e,t,n){function i(t){var n,i,a,o,s,u,r,d={},l="",c=e("./socket/json.js"),f=(e("./socket/websocket.js"),e("./socket/heartbeat.js")),p=e("../util/normatMessageAdapter.js"),h=e("./messagetype.json"),g=e("./messageMap.js"),m=e("../util/promise.js"),v=2,y=!0,j=t.Notification||t.webkitNotifications,b={},x=function(e,n){l=e.token||t.sessionStorage.getItem("temp-id"),n.resolve({success:!!e.token})},w=function(e){for(var t=[],n=0,i=e.length;i>n;n++){var a=e[n],o={type:300,utype:v,cid:a.cid,uid:a.uid,msgId:a.msgId};t.push(o)}$.ajax({url:"/chat/user/msg/ack.action",dataType:"json",data:{content:JSON.stringify(t),tnk:+new Date},type:"POST"}).success(function(e){}).fail(function(e){})},T=function(e){for(var t=[],n=0,i=e.length;i>n;n++){var a=e[n];if(!a.msgId){var o=Math.random().toString(36).substr(2);a.msgId=+new Date+""+a.cid+a.type+o}g.has(a.msgId)&&111!==a.type||(t.push(a),g.push([a]))}return t=t.sort(function(e,t){return e.t||(e.t=+new Date),t.t||(t.t=+new Date),e.t>t.t})},k=function(){var e=location.href,t=e.substring(e.lastIndexOf("?")+1);t.lastIndexOf("#")>=0&&(t=t.substring(0,t.lastIndexOf("#")));for(var n=t.split("&"),i={},a=0;a<n.length;a++){var o=n[a],s=o.substring(0,o.indexOf("=")),u=o.substring(o.indexOf("=")+1);/^-?(\d+)(\.\d+)?$/.test(u)?i[s]=Number(u):"true"===u?i[s]=!0:"false"===u?i[s]=!1:i[s]=u}return i},F=function(){s.start()},C=function(){m.when(function(){var e=new m;return $.ajax({url:"getEnvironment",data:{},dataType:"json"}).success(function(t){e.resolve({token:t.token})}).fail(function(t){e.reject({token:null})}),e}).then(x,x).then(function(e,i){$.ajax({url:"/chat/admin/connect.action",dataType:"json",type:"POST",data:{uid:n.id,way:1,st:n.st||1,lt:n.lt||(new Date).getTime(),token:l,ack:1}}).done(function(n){if(1==n.status||2==n.status){for(var a in n)b[a]=n[a];var o=location.href.indexOf("admins_new")<0?"admins/":"admins_new/";b.baseUrl=location.protocol+"//"+location.host+"/chat/"+(e.success?"":o),location.href.indexOf("www.sobot.com")>=0?b.socketBase="":b.socketBase="ws://test.sobot.com/webchat",e.success?b.scriptPath=b.baseUrl:b.scriptPath="//static.sobot.com/chat/admins/",$(".js-loading-layer").hide(),b.chatLogo?$(".js-company-logo").attr("src",b.chatLogo).show():($(".js-company-logo").attr("src","//static.sobot.com/chat/admins/assets/images/logo.png").show(),$(".js-company-name").show(),$(".js-company-domain").show()),i.resolve(n)}else alert("当前窗口登录失效，请重新登录"),$(t).unbind("beforeunload"),t.close(),t.location.href="/console/login"})}).then(function(e,t){new f(d).start(),o.trigger("core.onload",[b]),F()})},I=function(e){102===e.type&&(!document.hidden&&y||(r.play(),j&&_(e,102))),e.description=h[e.type]},B=function(e,t){a&&clearInterval(a);var n=0;a=setInterval(function(){n%2==0?document.title="用户"+e+"发送了一条消息":document.title=t,n++},1e3)},_=function(e,n){var i=103==n?"用户"+e.uname+"发送了一条消息":"新用户上线了！",a=103==n?e.desc:e.uname,s=$("<div></div>");s.html(a),a=s.html();var u=new j(i,{body:a,icon:"assets/images/logo.png",tag:"1"});document.hidden&&B(e.uname,a),u.onclick=function(e,n){return function(){t.focus(),n.close(),o.trigger("notification.click",[e])}}(e.uid,u),setTimeout(function(){u.close()},3e5)},D=function(e){for(var n=0,i=e.length;i>n;n++){var a=e[n];103===a.type?(p(a),!document.hidden&&y||(u.play(),j&&_(a,103))):109==a.type&&2==a.status?(alert("另外一个窗口已经登录，您被强迫下线！"),$(t).unbind("beforeunload"),t.close(),t.location.href="/console/login/"):I(a)}},S=function(){return b},q=function(){o=$(document.body)},z=function(){o.on("emergency.netclose",function(){alert("与服务器连接中断！"),$(t).unbind("beforeunload"),t.close(),t.location.href="/console/login"}),$(t).on("blur",function(){}),$(t).on("focus",function(){a&&(clearInterval(a),document.title="人工客服工作台")}),$(t).on("beforeunload",function(){return""}),t.onfocus=function(){y=!0},t.onblur=function(){y=!1}},O=function(){t.WebSocket,s=new c(b),s.on("receive",function(e){JSON.stringify(e);w(e),e=T(e),D(e),o.trigger("core.receive",[e])})},R=function(){j&&"granted"!==j.permission&&j.requestPermission(function(){i=j.requestPermission()})},A=function(){n=k();for(var e in n)b[e]=n[e];C(),O(),u=$("#audio1")[0],r=$("#audio2")[0],R()},L=function(){q(),z(),A()};return L(),d.getQueryParam=k,d.getGlobal=S,d}t.exports=i},{"../util/normatMessageAdapter.js":46,"../util/promise.js":47,"./messageMap.js":4,"./messagetype.json":5,"./socket/heartbeat.js":6,"./socket/json.js":7,"./socket/websocket.js":8}],4:[function(e,t,n){var i={},a=[],o=function(e){for(var t=0,n=e.length;n>t;t++){var i=e[t];a[i.msgId]=1}},s=function(e){return!!a[e]};i.push=o,i.has=s,t.exports=i},{}],5:[function(e,t,n){t.exports={102:"用户接入",103:"有新消息",108:"用户下线",109:"客服下线",110:"用户排队",111:"用户正在输入",112:"用户发送通话请求"}},{}],6:[function(e,t,n){function i(e){var t=e.getGlobal(),n=0,i=1e4,a=function(){$.ajax({url:"/chat/admin/msgt.action",type:"post",data:{pid:t.pid,token:+new Date,uid:t.id},dataType:"json"}).success(function(e){0==e.ustatus&&$(document.body).trigger("emergency.netclose")}).fail(function(e){n++,n>=6&&$(document.body).trigger("emergency.netclose")})};this.start=function(){setInterval(a,i)}}t.exports=i},{}],7:[function(e,t,n){function i(t){var n,i={},a=(e("../../util/unicode.js"),{answer:"",answerType:"",cid:"",docId:"",pid:"",questionId:"",uid:""}),o=function(e,t){i[e]=t},s=function(e){var t=$("<div></div>");if(t.html(e.answer),t.find("img.webchat_img_upload").length>0){var n=t.find("img.webchat_img_upload"),i=n.parent()[0];if(i&&"a"==i.tagName.toLowerCase()){n.removeClass("upNowImg").removeClass("uploadedFile");var a=n.parent().html();return a.replace(">","/>")}return e.answer}return e.answer},u=function(e,i,o){var o=o||0,r=s(i);$.ajax({url:"/chat/admin/send1.action",dataType:"json",type:"post",data:$.extend(a,{answer:r,cid:i.cid,uid:t.id,token:+new Date})}).success(function(e){setTimeout(function(){n.trigger("core.sendresult",[{token:i.date,type:"success",uid:i.uid}])},10)}).fail(function(){3==o?setTimeout(function(){n.trigger("core.sendresult",[{token:i.date,type:"fail",uid:i.uid}])},10):setTimeout(function(){u(e,i,o+1)},1e3)})},r=function(e,i,o){var o=o||0;1==i.data.status&&$.ajax({url:"/chat/admin/send1.action",dataType:"json",type:"post",data:$.extend(a,{answer:i.data.msg,docId:i.data.docid||"",answerType:i.data.docid&&i.data.docid.length?i.data.docid:"",cid:i.data.cid,uid:t.id})}).success(function(){setTimeout(function(){n.trigger("core.sendresult",[{token:data.date,type:"success",uid:data.uid}])},10)}).fail(function(){3==o?setTimeout(function(){n.trigger("core.sendresult",[{token:data.date,type:"fail",uid:data.uid}])},10):setTimeout(function(){r(e,i,o+1)},1e3)})},d=function(){n.on("textarea.send",u),n.on("rightside.onChatSmartReply",r)},l=function(e){var t=[];if(!e)return t;for(var n=0;n<e.length;n++){var i=JSON.parse(e[n]);t.push(i)}return t},c=function(){$.ajax({url:"/chat/admin/msg.action",dataType:"json",type:"POST",data:{puid:t.puid,uid:t.id,token:+new Date}}).success(function(e){if(e&&0!=e.length){var t=l(e);i.receive&&i.receive(t)}}).fail(function(e,t){}),setTimeout(c,1500)},f=function(){n=$(document.body)},p=function(){f(),d()};p(),this.on=o,this.start=c}t.exports=i},{"../../util/unicode.js":49}],8:[function(e,t,n){function i(e){var t,n=function(){},i=function(){t=new window.WebSocket(e.socketBase),t.onopen=function(){},t.onerror=function(){console.log("err")}};this.on=n,this.start=i}t.exports=i},{}],9:[function(e,t,n){!function(t){var n=e("./core/core.js")(window),i=e("./leftside/index.js"),a=e("./rightside/main.js"),o=e("./textarea/index.js"),s=e("./chatlist/index.js"),u=e("./scrollcontent/index.js"),r=(e("./util/promise.js"),e("./util/modal/dialog.js"),e("./util/load.js")(),50),d=function(){},l=function(){var e=$(window).outerHeight()-r;$("#main-container").height(e),$("#chatlist").height(e),$("#left-navigation").height(e),i($("section#left-navigation")[0],n,window),a($(".rightBox")[0],n,window),o($(".js-TextArea"),n,window),s($("#chatlist"),n,window),u($("#chatlist"),n,window)},c=function(){$(window).on("resize",function(e){var t=$(window).outerHeight()-r;$("#main-container").height(t),$("#chatlist").height(t),$("#left-navigation").height(t)})},f=function(){d(),c(),l()};f()}(document.body)},{"./chatlist/index.js":1,"./core/core.js":3,"./leftside/index.js":11,"./rightside/main.js":21,"./scrollcontent/index.js":27,"./textarea/index.js":31,"./util/load.js":41,"./util/modal/dialog.js":43,"./util/promise.js":47}],10:[function(e,t,n){function i(t,n,i,a,o){var s,u,r,d,l,c,f,p,a=a||"online",h=0,g=!1,m=!1,v=e("./unreadlist.js"),a=a||"online",y=n.getGlobal(),j=e("../util/normatMessageAdapter.js"),b={},x=(y.baseUrl,"history"==a||"blacklist"==a||"star"==a?"offline":"online"),w=0,T=e("../util/load.js")(),k=e("../util/promise.js"),F=e("../util/modal/alert.js"),C=e("./source.json");this.token=+new Date;var I=function(e){if(e&&e.cid==t.cid)if(e.message_type==h)d.html(e.desc).addClass("orange");else{var n=e.desc,i=$("<div></div>");i.html(n),n=i.html(),d.text(n).addClass("orange")}},B=function(e,n){for(var i=[],a=0;a<n.length;a++)103==n[a].type&&i.push(n[a]);var s=i.length>0?i[i.length-1]:null;if(t.uid!==o.getCurrentUid()){for(var a=0,u=n.length;u>a;a++){var d=n[a];d.cid===t.cid&&103==d.type&&w++}var l=w>99?"99+":w;w>0?r.html(l).css({visibility:"visible"}):r.css({visibility:"hidden"})}I(s)},_=function(){var e=u.parent(),t=e.find("li.offline"),n=t.length>0?t[0]:null;u.find(".js-icon").addClass("offline"),u.addClass("offline");var i=u.find(".js-user-status");i.css({display:"inline-block"}).html("[离线]"),x="offline",n?u.insertBefore(n):u.parent().append(u)},D=function(){c.trigger("leftside.onhide",[{cid:t.cid,uid:t.uid}]),u.animate({height:0},300,function(){u.remove()}),o.getCurrentUid()==t.uid&&o.setCurrentUid(null)},S=function(){if("online"==x){var e=new F({title:"结束对话",text:"请确认顾客的问题已经解答，是否结束对话？",OK:function(){$.ajax({url:"/chat/admin/leave.action",data:{cid:t.cid,uid:y.id,userId:t.uid},type:"post",dataType:"json"}).success(function(e){o.getCurrentUid()==t.uid&&o.setCurrentUid(null),c.trigger("leftside.onremove",[{cid:t.cid,uid:t.uid}]),1===e.status&&D()})}});e.show()}else D()},q=function(e){p||(p=$(i).find("ul.js-users-list"));var t=p.children();if(0==t.length)p.append(e);else{var n=t[0];e.insertBefore(n)}},z=function(e){x="online",t.cid=e,c.trigger("leftside.cidchange",{cid:t.cid,uid:t.uid});var n=u.find(".js-user-status");u.find(".js-icon").removeClass("offline"),u.removeClass("offline"),n.css({display:"none"}),1==t.isTransfer?n.html("[转接]"):n.html(""),0!==u.index()&&q(u),o.getCurrentUid()==t.uid&&c.trigger("leftside.oncidchange",[t.cid])},O=function(){var e=t.face,n=new Image;n.onload=function(){f.attr("src",e).css({display:"inline-block"})},n.src=e},R=function(e,n){var i=v.getList(t.uid);if(i){for(var a=[],o=0;o<i.length;o++)103==i[o].type&&a.push(i[o]);w=a.length;var s=a.length>0?a[a.length-1]:null;I(s),r.html(a.length).css({visibility:"visible"})}},A=function(){var e=new k,n=$(i).find('li[data-uid="'+t.uid+'"]');return n.length>0?(s=n[0],u=$(s),l=u.find(".js-user-name"),f||(f=u.find(".js-image-face")),O(),setTimeout(function(){g=!0,e.resolve()},0)):T.load(y.baseUrl+"views/leftside/chatitem.html").then(function(n){if(t.source_type=C[t.usource],0!=t.isTransfer&&console.log("转接"+t.uid+" chattype="+t.isTransfer),1==t.usource&&(t.imgUrl="img/weixinType.png"),t.face&&t.face.length&&(t.source_type="face",t.imgUrl=t.face),!t.source_type){var o=t.usource||t.source;t.source_type=C[o]}t.type=a;var s=doT.template(n)(t);u=$(s),f||(f=u.find(".js-image-face")),O(),"online"==a?q(u):(p||(p=$(i).find("ul.js-users-list")),p.append(u)),l=u.find(".js-user-name"),g=!0,e.resolve()}),e},L=function(){return g},N=function(){return x},U=function(){w=0,r.html("").css({visibility:"hidden"})},P=function(){var e=new k,n=t.uid;return b[n]?setTimeout(function(){e.resolve(b[n])},0):$.ajax({url:"/chat/admin/get_userinfo.action",type:"POST",dataType:"json",data:{sender:y.id,uid:t.uid}}).success(function(t){0==t.retcode&&(b[n]=t.data,e.resolve(t.data))}),e},G=function(e){var n=$(e.target);if(!n.hasClass("js-remove")){var i=w;U(),u.addClass("active").siblings().removeClass("active"),t.from=a,t.status=x,k.when(P).then(function(e){t.uid!==o.getCurrentUid()&&$(document.body).trigger("leftside.onselected",[{data:t,userData:e,unreadcount:i,status:x}])})}},M=function(){u.trigger("click")},E=function(e,n){if(n.data.uid==t.uid){if(1==n.data.update&&n.data.name){var i=n.data.name;l.html(i)}delete b[t.uid]}},H=function(e,n){delete b[t.uid],m||("online"==a&&"black"==n.type&&"add"==n.handleType&&n.userId===t.uid&&D(),"black"==n.type&&"del"==n.handleType&&n.userId===t.uid&&"blacklist"===a&&D(),"star"==n.type&&"star"==a&&"del"==n.handleType&&n.userId===t.uid&&D(),"star"==n.type&&P())},X=function(e,n){n.uid==t.uid&&(j(n),n.message_type==h?d.html(n.desc).removeClass("orange"):d.text(n.desc).removeClass("orange"))},Z=function(e,n){if(1==n.data.status&&n.data.cid==t.cid){var i=n.data.msg.indexOf("<")>=0?"[富文本]":n.data.msg;d.text(i)}},K=function(e,n){n.uid==t.uid&&(o.setCurrentUid(void 0),D())},W=function(){c.on("scrollcontent.onUpdateUserState",H),c.on("scrollcontent.onTransfer",K),c.on("rightside.onChatSmartReply",Z),c.on("textarea.send",X),u.on("click",G),c.on("rightside.onProfileUserInfo",E)},V=function(){r=u.find(".js-unread-count"),p=$(i).find("ul.js-users-list"),d=u.find(".js-last-message")},Q=function(){},J=function(e,t){m||setTimeout(function(){B(e,t)},1)},Y=function(){c=$(document.body),c.on("core.receive",J)},ee=function(){V(),W(),Q()},te=function(){m=!0,c.unbind("core.receive",J)};A().then(function(e,t){return ee(),setTimeout(t.resolve,1),t}).then(R),Y(),this.onOnline=z,this.destroy=te,this.getStatus=N,this.onclick=M,this.onRemove=S,this.getReady=L,this.onOffLine=_}t.exports=i},{"../util/load.js":41,"../util/modal/alert.js":42,"../util/normatMessageAdapter.js":46,"../util/promise.js":47,"./source.json":15,"./unreadlist.js":17}],11:[function(e,t,n){function i(t,n,i){var a,o,s,u,r,d,l,c,f,p,h={},g=(e("./template.js"),e("../util/load.js")()),m=e("./queue.js"),v=79,y=41,j=47,b=["","/chat/admin/online.action","/chat/admin/busy.action"],x=["","online","buzy"],w=e("./online.js"),T=e("./offline.js"),k=e("../util/modal/alert.js"),F=function(){s=$(t),c=s.find(".js-server-group"),u=s.find(".js-menuDropdown"),r=s.find(".js-status-menu"),d=s.find(".js-status-image"),f=s.find(".js-wait-outer"),l=s.find(".js-invite-btn")},C=function(){new m(n,i)},I=function(){$.ajax({url:"/chat/admin/getAdminChats.action",type:"POST",dataType:"json",data:{uid:p.id}}).success(function(e){D({count:e.waitSize})})},B=function(e){var t=$(e.currentTarget),n=t.index();t.addClass("active").siblings().removeClass("active"),0==n?(a.show(),o.hide()):(a.hide(),o.show())},_=function(e){var t=e.currentTarget,n=$(t).attr("data-status");r.removeClass("active");var a=b[n];if(2>=n&&n>0)$.ajax({url:a,type:"POST",dataType:"json",data:{uid:p.id}}).success(function(e){for(var t=0;t<x.length;t++)d.removeClass(x[t]);d.addClass(x[n])});else{var o=new k({title:"确认离线",text:"请确定是否要下线？",OK:function(){$.ajax({url:"/chat/admin/out.action",type:"post",dataType:"json",data:{uid:p.id}}).success(function(e){1==e.status&&($(i).unbind("beforeunload"),i.location.href="/console/login")})}});o.show()}},D=function(e){g.load(p.baseUrl+"views/leftside/queuelength.html").then(function(t){var n=doT.template(t)(e);f.html(n)})},S=function(e,t){for(var n=0,i=t.length;i>n;n++){var a=t[n];switch(a.type){case 110:D(a)}}},q=function(){var e=$(i).outerHeight()-(v+y+j);a.onResize(e),o.onResize(e);var t=$("#historylist"),n=t.parent();t.css("height",n.outerHeight()-47)},z=function(e,i){p=n.getGlobal(),I();for(var a=0;a<x.length;a++)d.removeClass(x[a]);d.addClass(x[p.status]),$(t).find("img.js-my-logo").attr("src",i.face),$(t).find(".js-customer-service").html(i.name).attr("title",i.name),c.html(p.cusRoleName)},O=function(){$(document.body).on("core.onload",z),$(document.body).on("core.receive",S),$(document.body).on("click",function(){r.removeClass("active")}),s.delegate(".js-tab-item","click",B),u.on("click",function(e){e.stopPropagation(),r.toggleClass("active")}),s.delegate(".js-status","click",_),l.on("click",C),$(i).on("resize",q)},R=function(){a=w(s.find(".js-chatonline")[0],n,i),o=T(s.find(".js-history-outer")[0],n,i),q()},A=function(){F(),O(),R()};return A(),h}t.exports=i},{"../util/load.js":41,"../util/modal/alert.js":42,"./offline.js":12,"./online.js":13,"./queue.js":14,"./template.js":16}],12:[function(e,t,n){function i(t,n,i){var a,o,s,u,r,d,l={},c=e("./source.json"),f=e("./chatItem.js"),p=["noAll","noStar","noBlack"],h=e("../util/load.js")(),g=e("../util/promise.js"),m=e("../util/normatMessageAdapter.js"),v=0,y=1,j=!1,b=79,x=41,w=47,T={},k={},F=n.getGlobal(),C=["/chat/admin/get_histroryUser.action","/chat/admin/query_marklist.action","/chat/admin/query_blacklist.action"],I=function(){a=$(t),o=a.find(".js-history-list"),s=o.parent()},B=function(e){if(!j){var t=s.scrollTop(),n=s.outerHeight(),i=o.outerHeight(),a=Math.abs(t+n-i);1>a&&(y++,q(d,r,!0))}},_=function(e){u=e},D=function(){return u},S=function(e){for(var t=0,n=e.length;n>t;t++){var i=e[t];i.source_type=c[i.source],i.content=i.lastMsg,m(i),1==i.source&&(i.imgUrl="img/weixinType.png"),i.face&&i.face.length&&(i.source_type="face",i.imgUrl=i.face),i.uid=i.id}},q=function(e,i,a){var a=a===!0,s=C[e],i=i||"history";r=i,d=e,g.when(function(){var e=new g;return $.ajax({url:s,type:"POST",dataType:"json",data:{uid:F.id,pageNow:y}}).success(function(t){S(t),0==t.length&&(j=!0);for(var n=0;n<t.length;n++){var i=t[n];T[i.uid]=i}e.resolve(t)}),e}).then(function(s,r){h.load(F.baseUrl+"views/leftside/chatlist.html").then(function(r){for(var d in k)k[d].destroy();if(!a){var c=p[e],h=doT.template(r)({list:s,type:i,className:c});o.html(h)}for(var g=0,m=s.length;m>g;g++){var v=new f(s[g],n,t,i,l);k[s[g].uid]=v}u&&setTimeout(function(){k[u].onclick()},10)})})},z=function(){},O=function(e){var t=$(e.currentTarget);t.addClass("active").siblings().removeClass("active");var n=t.index(),i=t.attr("data-key");y=1,j=!1,q(n,i)},R=function(){o.html(""),a.show(),a.find(".js-switch-label").eq(v).trigger("click")},A=function(){a.find("li.user-list-item").removeClass("active"),u=null},L=function(e,t){"online"==t.data.from?A():u=t.data.uid},N=function(){a.hide()},U=function(e){a.css({height:e})},P=function(){$(document.body).on("core.onload",z),$(document.body).on("leftside.onselected",L),s.on("scroll",B),a.delegate(".js-switch-label","click",O)},G=function(){a.css({height:$(i).outerHeight()-(b+x+w)})},M=function(){I(),P(),G()};return M(),l.show=R,l.hide=N,l.onResize=U,l.getCurrentUid=D,l.setCurrentUid=_,l}t.exports=i},{"../util/load.js":41,"../util/normatMessageAdapter.js":46,"../util/promise.js":47,"./chatItem.js":10,"./source.json":15}],13:[function(e,t,n){function i(t,n,i){var a,o,s,u,r={},d={},l=e("./unreadlist.js"),c=e("./source.json"),f=e("./chatItem.js"),p=e("../util/normatMessageAdapter.js"),h=(e("../util/modal/alert.js"),e("../util/load.js")()),g=function(){var e=0;for(var t in d)e++;0==e?a.addClass("noOnline"):a.removeClass("noOnline")},m=function(){a.find("li.user-list-item").removeClass("active"),u=null},v=function(e){u=e},y=function(e,t){delete d[t.uid]},j=function(){return u},b=function(e,t){delete d[t.uid],g()},x=function(e){var i=e.uid;if(void 0===e.isTransfer&&(e.isTransfer=e.chatType),d[i]&&"offline"==d[i].getStatus())d[i].onOnline(e.cid);else{var a=new f(e,n,t,null,r);d[e.uid]=a}g()},w=function(){a.hide()},T=function(){$.ajax({url:"/chat/admin/getAdminChats.action",dataType:"json",type:"POST",data:{uid:s.id}}).success(function(e){if(e.userList.length>0)h.load(s.baseUrl+"views/leftside/chatlist.html").then(function(i){for(var a=0,o=e.userList.length;o>a;a++){var s=e.userList[a];s.content=s.lastMsg,p(s),void 0===s.isTransfer&&(s.isTransfer=s.chatType),1==s.usource&&(s.imgUrl="img/weixinType.png"),s.face&&s.face.length&&(s.source_type="face",s.imgUrl=s.face),s.source_type=c[s.usource],s.face&&s.face.length&&(s.source_type="face")}var u=doT.template(i)({list:e.userList,type:"online"});$(t).find(".js-users-list").html(u);for(var a=0,o=e.userList.length;o>a;a++){var s=e.userList[a];d[s.uid]=new f(s,n,t,null,r)}});else{$(t).outerHeight();a.addClass("noOnline")}})},k=function(e,t){"online"==t.data.from?u=t.data.uid:m()},F=function(e){var t=e.currentTarget,n=$(t).attr("data-uid");d[n]&&(u=n,d[n].onRemove())},C=function(e){$.ajax({url:"/chat/admin/log.action",type:"post",data:{msg:e.msgId,pid:s.pid,uid:s.myid,puid:s.puid,code:"02",detail:"推送消息时，页面没有这个用户"}})},I=function(e){var t={};for(var n in e)t[n]=e[n];t.type=102,x(t),l.push(e.uid,e)},B=function(e,t){for(var n=0,i=t.length;i>n;n++){var a=t[n];switch(a.type){case 102:d[a.uid]?"offline"===d[a.uid].getStatus()&&x(a):x(a);break;case 108:z(a);break;case 103:d[a.uid]?d[a.uid].getReady()||l.push(a.uid,a):(I(a),C(a))}}},_=function(e){},D=function(){a.show()},S=function(e,t){t!==u&&a.find('li[data-uid="'+t+'"]').trigger("click")},q=function(e,t){s=n.getGlobal(),T(),h.load(s.baseUrl+"views/leftside/chatitem.html")},z=function(e){var t=e.uid;d[t]&&d[t].onOffLine()},O=function(){o.on("core.onload",q),o.on("core.receive",B),o.on("notification.click",S),o.on("leftside.onselected",k),o.on("leftside.onhide",y),o.on("leftside.onremove",b),a.delegate(".js-remove","click",F)},R=function(){a=$(t),o=$(document.body)},A=function(e){a.css({height:e})},L=function(){},N=function(){R(),O(),L()};return N(),r.hide=w,r.onResize=A,r.getCurrentUid=j,r.setCurrentUid=v,r.show=D,r.onRemoveItem=_,r}t.exports=i},{"../util/load.js":41,"../util/modal/alert.js":42,"../util/normatMessageAdapter.js":46,"./chatItem.js":10,"./source.json":15,"./unreadlist.js":17}],14:[function(e,t,n){function i(t,n){var i,a,o,s,u,r,d,l,c,f,p,h,g,m=t.getGlobal(),v=e("../util/modal/dialog.js"),y=e("../util/load.js")(),j=e("../util/promise.js"),b=e("../util/datetime.js"),x=0,w=[0,0],T=["/chat/admin/queryUser.action","/chat/admin/queryVisitUser.action"],k=["views/leftside/queueitem.html","views/leftside/visitqueue.html"],F=1;this.token=+new Date;var C=function(e){var t=e.currentTarget,n=$(t).attr("data-index");F=1,x=n,$(t).addClass("active").siblings().removeClass("active"),B()},I=function(e,t){var n=e.html,o=e.data;o.currentPage=0==o.countPage?0:o.currentPage,o.isInvite=m.isInvite,w[x]=o.waitSize,g=o.countPage,o.currentTime=b.getTime(new Date);var s=doT.template(n)(o);return i.setInner(s),i.show(),a=$(i.getOuter()),S(),O(),setTimeout(t.resolve,0),t},B=function(){y.load(m.baseUrl+k[x]).then(D).then(function(e,t){g=e.data.countPage;var n=["waitSize","visitSize"],i=[l,c],a=e.data[n[x]];"number"==typeof a&&(i[x].html(a),w[x]=a,r.text(a)),o.html(g),s.html(0==g?0:F),d.html(b.getTime(new Date));var u=doT.template(e.html)({list:e.data.list});p.html(u)})},_=function(){var e=h.val(),t=+e;0==e.length||isNaN(t)||(0>=t?t=1:t>=g&&(t=g),h.val(t),F=t,B())},D=function(e,t){var t=t||new j,n=e;return $.ajax({url:T[x],dataType:"json",type:"POST",data:{uid:m.id,status:3,pageNow:F}}).success(function(e){e.currentPage=F,t.resolve({data:e,html:n})}),t},S=function(){s=a.find(".js-current-page"),o=a.find(".js-all-count-page"),u=a.find(".js-page-jump-btn"),h=a.find(".js-input"),f=a.find(".js-refresh-btn"),p=a.find(".js-table-outer"),d=a.find(".js-refresh-time"),l=a.find(".js-wait-size"),c=a.find(".js-visit-size"),r=a.find(".js-count-size")},q=function(e){var t=e.currentTarget;if(!$(t).hasClass("disabled")){var n=$(t).attr("data-uid");$.ajax({url:"/chat/admin/invite.action",dataType:"json",type:"post",data:{uid:m.id,userId:n}}).success(function(e){1==e.status?(w[x],a.find(".js-size-btn").eq(x).html(--w[x]),$(t).html("已邀请").addClass("disabled").css({color:"#808080"})):2==e.status&&(w[x],a.find(".js-size-btn").eq(x).html(--w[x]),$(t).html("邀请失败").addClass("disabled").css({color:"#808080"}))}).fail(function(e,n){$(t).html("失败").addClass("disabled").css({color:"#808080"})})}},z=function(e){var t=e.currentTarget,n=$(t).attr("data-type");"prev"==n?F=1>=F?1:F-1:"next"==n&&(F=F>=g-1?g:F+1),B()},O=function(){a.delegate(".js-page-btn","click",z),u.on("click",_),a.delegate(".js-invite-btn","click",q),a.delegate(".js-queue-tab","click",C),f.on("click",function(){B()})},R=function(){i=new v({title:"邀请会话",footer:!1}),y.load(m.baseUrl+"views/leftside/queuelist.html").then(function(e,t){return D(e,t)}).then(I).then(function(){$.ajax({url:T[1],dataType:"json",data:{uid:m.id,status:1,pageNow:1},type:"post"}).success(function(e){w[1]=e.visitSize,a.find(".js-size-btn").eq(1).html(e.visitSize)})})},A=function(){R()};A()}t.exports=i},{"../util/datetime.js":36,"../util/load.js":41,"../util/modal/dialog.js":43,"../util/promise.js":47}],15:[function(e,t,n){t.exports=["laptop","weixin","app","weibo","mobile","rongyun"]},{}],16:[function(e,t,n){var i={};i.listItem='<li title="{{=it.uname}}" ><a href="javascript:;" class="user"  name="{{=it.uname}}" usource="0" data-uid="c8502966db3f40538794a4e9ab9a8c49"><i class="fa fa-laptop"><span class="newIcon"></span></i><span class="uname">{{=it.uname}}</span><span class="lastMsg"><span style="color:#ffad01">sfsad</span></span><span class="badge badge-red msg-count"></span><i class="user-del"  style="display: none;"><span class="newIcon"></span></i><span class="ohide">{{=it.uname}}</span></a></li>',t.exports=i},{}],17:[function(e,t,n){var i={},a=function(e,t){i[e]||(i[e]=[]),i[e].push(t)},o=function(e){delete i[e]},s=function(e){return i[e]};i.push=a,i.remove=o,i.getList=s,t.exports=i},{}],18:[function(e,t,n){var i=!1,a={showClientSys:null},o=function(t,n,o){function s(){$(l).removeClass("show").animate({"margin-top":"-200"},500);var e=$(this);a.showClientSys=e.index()+1,$(c).height($(t).find(".js-tab-content").height()),$(c).width($(t).find(".js-tab-content").width()),$(c).attr("src",e.find("a").attr("addrurl")).ready()}var u,r,d,l,c,f,p,h=n.getGlobal(),g=e("../../util/load.js")(),m=e("../../util/promise.js"),v=function(){var e=new m;return $.ajax({type:"post",cache:!1,url:"/chat/admin/getIframe.action",data:{uid:h.id,userId:o.userData.uid},dataType:"json",success:function(t){p=t,e.resolve()}}),e},y=function(){u=$(t).find(".js-nav-tabs .js-dropdownNav"),r=$(t).find(".js-tab-content .js-clientSystemWrap"),c=$(t).find(".js-tab-content .js-clientSysIframe"),d=$(u).find(".js-dropdown-toggle"),l=$(u).find(".js-dropdown-menu"),f=$(t).find(".js-tab-content")},j=function(){$(l).hasClass("show")?$(l).removeClass("show").animate({"margin-top":"-200"},500):$(l).addClass("show").animate({"margin-top":"0"},500)},b=function(){i||($(d).on("click",j),i=!0)},x=function(){if(!(p&&p.length>0))return void $(u).addClass("hide");var e=p;if(1==e.length){$(u).removeClass("hide");for(var t=0;t<e.length;t++)for(var n in e[t])$(c).height($(f).height()),$(c).width($(f).width()),$(d).attr("addrurl",e[t][n]).attr("data-toggle","tab"),$(d).on("click",function(){$(c).attr("src",$(d).attr("addrurl")).ready()}),$(c).attr("src",$(d).attr("addrurl")).ready()}else{var i=$(l);if(g.load(h.baseUrl+"views/rightside/menutemp.html").then(function(t){var n=doT.template(t)({list:e});i.html(n),$(l).on("click","li",s)}),a.showClientSys)for(var o in e[a.showClientSys-1])$(c).attr("src",e[a.showClientSys-1][o]);else $(u).removeClass("hide")}},w=function(){y(),x(),b()};v().then(w)};t.exports=o},{"../../util/load.js":41,"../../util/promise.js":47}],19:[function(e,t,n){var i=function(t,n,i){var a,o,s,u,r,d,l,c,f=(n.getGlobal(),{uid:""}),p=function(t){function n(t){if(t.answer?(null===t.pid&&(t.pid=0),$(u).find("a").html(t.answer),$(u).find("a").attr("answerType",t.answerType),$(u).find("a").attr("docId",t.docId),$(u).find("a").attr("pid",t.pid),$(u).find("a").attr("questionId",t.questionId),$(o).find("a").css("color","#f90")):$(o).find("a").css("color","#ddd"),$(o).show(),null!==t.sugguestions){$(s).show(),$(r).find("ul").html("");for(var n=e("./template.js"),i=0;i<t.sugguestions.length;i++){var a=$.extend({num:i+1,question:i+1+"."+t.sugguestions[i].question}),d=doT.template(n.sugguestionsItem)(a);$(r).find("ul").append(d)}}}if(""!==$(l).val()){$(o).hide(),$(s).hide(),$(u).find("a")[0].innerHTML="",$(r).find("ul")[0].innerHTML="";var a="/chat/admin/internalChat1.action";$.ajax({type:"post",url:a,dataType:"json",data:{uid:i.id,requestText:t},success:function(e){n(e)}})}},h=function(e,t){f.uid=t?t.userData.uid:"",f.cid=t?t.data.cid:""},g=function(e){var t=$(this),n={},i=$(u).find("a");""!==i.html()&&""!==f.uid&&""!==f.cid&&(t.hasClass("quickSendBtn")?(n.status="1",n.msg=$(u).find("a").html(),n.docid=$(u).find("a").attr("docid")):(n.status="2",n.txt=t.text(),n.msg=t.html()),n.uid=f.uid,n.cid=f.cid,$(document.body).trigger("rightside.onChatSmartReply",[{data:n}]))},m=function(){p($(a).find("input#quickSerch")[0].value),$(this).hide()},v=function(){p($(this).attr("list")),setTimeout(function(){$(a).find(".js-robotBackHideBtn").show()},100)},y=function(){var e=$(this);0!==e.val().length&&(clearTimeout(c),c=setTimeout(function(){p(e.val()),$(a).find(".js-robotBackHideBtn").hide()},500))},j=function(e){var t=$(this);0!==t.val().length&&13==e.keyCode&&(p(t.val()),$(a).find(".js-robotBackHideBtn").hide())},b=function(e,t){p(t.data)},x=function(e,n){var i=$(t).find(".js-panel-body .js-nav-tabs #homeuser"),a=$(t).find(".js-panel-body .js-tab-content"),o=$(i).attr("id");$(i).addClass("active").siblings("li").removeClass("active"),$(a).find(".js-tab-pane").each(function(e,t){return $(t).attr("id")==o.toString()?($(t).addClass("active in").siblings("div").removeClass("active in"),$(t).find("input").val(n.str),void p(n.str)):void 0})},w=function(){a=$(t).find(".js-tab-pane#homeuser"),o=$(t).find(".js-homeUserBox .js-robotDirectHideBtn"),s=$(t).find(".js-homeUserBox .js-relevantSearchHideBtn"),u=$(t).find(".js-robotAnswer"),r=$(t).find(".js-robotSugguestions"),d=$(t).find(".js-robotBackHideBtn"),l=$(t).find(".js-searchBot input")},T=function(){$(document.body).on("leftside.onselected",h),$(document.body).on("scrollcontent.onSearchUserChat",x),$(document.body).on("rightside.onTabSwitch",b),$(d).on("click",m),$(a).delegate("#quickSerch","input propertychange",y),$(a).delegate("#quickSerch","keyup",j),$(o).delegate(".js-quickSendBtn","click",g),$(u).delegate("a","click",g),$(r).delegate("li","click",v)},k=function(){w(),T()};k()};t.exports=i},{"./template.js":20}],20:[function(e,t,n){var i={},a="<li list={{=it.num}}>{{=it.question}}</li>";i.sugguestionsItem=a,t.exports=i},{}],21:[function(e,t,n){function i(t,n,i){var a=n.getGlobal(),o={version:"5.0",isShowBg:!0};o.id=a.id;var s,u,r,d,l=[],c=e("./profileuser/index.js"),f=e("./messagesuser/index.js"),p=e("./homeuser/index.js"),h=e("./clientsystems/index.js"),g=function(e,n){
var a=($(i).height(),$(i).height()-50);$(t).find(".js-tab-pane-profileuser").css("height",a-52+"px"),$(t).find(".js-rightQuickLeft").css("height",a-80-52+"px"),$(t).find(".js-rightQuickRight").css("height",a-80-52+"px"),$(t).find(".js-tab-pane-homeuser .js-homeUserBox").css("height",a-52-40-52+"px"),$(t).find(".js-clientSysIframe").css("height",a-52+"px")};$(i).resize(function(){g()});var m=function(e,n){var i=$(e);"profileuser"==i.attr("id")&&o.isShowBg?$(t).find(".js-panel-body").addClass("showBg"):$(t).find(".js-panel-body").removeClass("showBg"),"clientSystem"!=i.attr("id")&&$(t).find(".js-dropdown-menu").removeClass("show").animate({"margin-top":-200},500);var a=i.attr("id");$(r).find(".js-tab-pane").each(function(e,t){$(t).attr("id")==a.toString()&&$(t).addClass("active in").siblings("div").removeClass("active in")}),i.addClass("active").siblings("li").removeClass("active");var s=$(r).find(".js-tab-pane#homeuser .js-searchBot input");$(s).val(n)},v=function(){var e=$(this).attr("id"),t="";if(s)for(var n=0;n<l.length;n++){var i=l[n];if(i.uid==s.uid){var a=$(r).find(".js-tab-pane#homeuser .js-searchBot input");i.item.zIndex=e,t=$(a).val(),i.item.homeuser=t}}m($(this),t)},y=function(e){for(var t=$(r).find(".js-tab-pane#homeuser .js-searchBot input"),n=$(t).val(),i=0;i<l.length;i++){var a=l[i];a.uid==e&&(n=a.item.homeuser,$(u).find(".js-menu").each(function(e,t){$(t).attr("id")==a.item.zIndex&&(m($(t),n),$(document.body).trigger("rightside.onTabSwitch",{data:n}))}))}},j=function(e){var t=$($(u).find("li")[0]).attr("id"),n=!0;if(e){for(var i=0;i<l.length;i++){var a=l[i];if(a.uid==e)return void(n=!1)}if(n){var o={uid:e,item:{zIndex:t,profileuser:"",messagesuser:"",homeuser:"",clientSystem:""}};l.push(o)}}},b=function(){for(var e=0;e<l.length;e++)if(s.uid==l[e].uid){var t=$(r).find(".js-tab-pane#homeuser .js-searchBot input").val();l[e].item.homeuser=t}},x=function(e){13==e.keyCode&&b()},w=function(){b()},T=function(e,i){o.isShowBg=!1,o.from=i.data.from,c($(".js-tab-pane#profileuser"),n,i),h(t,n,i),"history"==i.data.from?$(t).find(".js-robotDirectHideBtn a").removeClass("js-quickSendBtn"):$(t).find(".js-robotDirectHideBtn a").addClass("js-quickSendBtn"),j(i.data.uid),y(i.data.uid),s=i.data,$(t).find(".js-panel-body").removeClass("showBg")},k=function(){o.isShowBg=!0,$(t).find(".js-tab-pane#profileuser").html('<i class="js-tab-profilebg tab-profilebg"></i>').find(".js-tab-profilebg").removeClass("hide")},F=function(){u=$(t).find(".js-panel-body .js-nav-tabs"),r=$(t).find(".js-panel-body .js-tab-content"),$(t).find(".js-panel-body").addClass("showBg"),d=$(r).find(".js-tab-pane#homeuser .js-searchBot")},C=function(){$(i).on("core.onload",g),$(document.body).on("leftside.onselected",T),$(document.body).on("leftside.onhide",k),$(u).on("click",".js-menu",v),$(d).delegate("input","keyup",x),$(d).delegate("input","blur",w)},I=function(){f(t,n,o),p(t,n,o)},B=function(){F(),C(),I()};$(document.body).on("core.onload",function(e){B()})}t.exports=i},{"./clientsystems/index.js":18,"./homeuser/index.js":19,"./messagesuser/index.js":23,"./profileuser/index.js":26}],22:[function(e,t,n){var i=function(t,n,i){var a=(n.getGlobal(),i.fastData,i.id);i.repBtnType=!0;var o,s,u,r,d,l,c=this,f=e("./toTopAnimate.js"),p={l001:"确定删除该快捷分组？",l002:"确定删除该快捷回复？"},h=function(){o=t,s=$(o).find(".js-leftContent ul"),u=$(o).find(".js-rightContent ul"),r=$(o).find(".js-addNewGroup"),d=$(o).find(".js-addNewRep"),l=$(o).find(".js-content")},g=function(e){$(t).find(".js-quickContent ul .detalBar span").removeClass("hide"),$($(t).find(".js-quickLeft ul li")[0]).find(".js-upLeftGroup").addClass("hide"),$($(t).find(".js-quickRight ul li.show")[0]).find(".js-upRightRep").addClass("hide"),e&&$(document.body).trigger("rightside.oReLoadRightGroup")},m=function(){var e=$(this),t=[];e.addClass("activeLine").siblings("li").removeClass("activeLine"),e.find("input").addClass("activeLine").parent("li").siblings("li").find("input").removeClass("activeLine");var n=$(u).find("li");$(n).removeClass("show").addClass("hide");for(var i=0;i<n.length;i++)$(n[i]).attr("gid")==e.attr("gid")&&(t.push(n[i]),$(n[i]).addClass("show"),$(n[i]).find("input").removeClass("hide"));e.hasClass("activeLine")?$(d).show():$(d).hide(),$(t[0]).find(".js-upRightRep").addClass("hide")},v=function(){var e=$(this);e.addClass("activeLine").siblings("li").removeClass("activeLine"),e.find("input").addClass("activeLine").parent("li").siblings("li").find("input").removeClass("activeLine")},y=function(){var e,t,n,i,o,s=$(this);"left"==s.siblings("input").attr("utype")?(e=p.l001,t=s.parent(".js-detalBar").attr("gid"),n="/chat/reply/delreplyGroup.action",i="groupId",o={groupId:t,userId:a}):(e=p.l002,t=s.parent(".js-detalBar").attr("qid"),n="/chat/quick/delquickReply.action",i="id",o={id:t,userId:a}),s.text("确认删除").css("color","red"),s.hasClass("sureDel")?t&&$.ajax({type:"post",url:n,data:o,dataType:"json",success:function(e){e.status&&s.parent(".js-detalBar").animate({height:0},300,function(){s.parent(".js-detalBar").remove(),g(!0)})}}):s.addClass("sureDel")},j=function(){var e,t,n,i,o=$(this);"left"==o.siblings("input").attr("utype")?(e="/chat/reply/setTopGroup.action",n=o.parent(".js-detalBar").attr("gid"),t="groupId",i={groupId:n,userId:a}):(e="/chat/quick/setTopReply.action",n=o.parent(".js-detalBar").attr("qid"),t="id",i={id:n,userId:a}),t&&$.ajax({type:"post",url:e,data:i,dataType:"json",success:function(e){if(e.status){var t=o.parent("li"),n=o.parents("ul");f(n,t,function(){g(!0)})}}})},b=function(e){var t=$(this),n=e.which;return 13!=n||e.shiftKey?void 0:(t.blur(),!1)},x=function(e){$(s).find("li").hasClass("activeLine")?$(d).show():$(d).hide();var t=$(this);if(""===t.val().replace(/(^\s*)|(\s*$)/g,"")||null===t.val()||void 0===t.val()){var n=t.parent(".js-detalBar").attr("gid");return void(n?t.val(c.inputText):t.parent(".js-detalBar").remove())}t.val()!=c.inputText&&("left"==t.attr("utype")?F.onFastLeftBlurSaveData(t):F.onFastRightBlurSaveData(t))},w=function(){c.inputText=$(this).val()},T=function(){i.repBtnType=!1},k=function(n){$(d).show(),$(t).find(".js-content ul li").find("input").removeClass("newInput");var i,a,o,r,l="js-addNewGroup"===n.target.className?s:u;l==s?(i="js-delLeftGroup delLeftGroup",a="js-upLeftGroup upLeftGroup hide",r="left",o=50,$(s).find("li").removeClass("activeLine"),$(s).find("input").removeClass("activeLine"),$(u).find("li").removeClass("show").addClass("hide")):(i="js-delRightRep delRightRep",a="js-upRightRep upRightRep hide",r="right",o=2048,$(u).find("li").removeClass("activeLine"),$(s).find("input").removeClass("activeLine"));var c=e("./template.js"),f=$.extend({utype:r,clsDelName:i,clsUpName:a,maxlength:o}),p=doT.template(c.zcReplyOuter)(f),h=$(l).find("li")[$(l).find("li").length-1];$(l).find("li").length>0?$(h).find("input").val()?($(l).append(p),$(t).find(".js-content li input.newInput").focus()):$(h).remove():$(l).append(p)},F={onFastLeftBlurSaveData:function(e){var t=$(e),n=t.parent(".js-detalBar").attr("gid"),i=$(e).val().replace(/(^\s*)|(\s*$)/g,"");if(n){var o="/chat/reply/updreplyGroup.action";$.ajax({type:"post",url:o,data:{groupId:n,groupName:i,userId:a},dataType:"json",success:function(t){t.status&&(g(!0),$(e).val(i))}})}else{var s="/chat/reply/addreplyGroup.action";$.ajax({type:"post",url:s,data:{groupName:i,userId:a},dataType:"json",success:function(t){t.status&&($(e).parent(".js-detalBar").attr("gid",t.groupId),g(!0))}})}},onFastRightBlurSaveData:function(e){var t=$(e),n=t.parent(".js-detalBar"),i=($(n).index(),$(n).attr("gid")),o=t.val(),u=n.attr("qid");if(u){var r="/chat/quick/updquickReply.action";$.ajax({type:"post",url:r,data:{id:u,value:o,userId:a},dataType:"json",success:function(e){e.status&&g(!0)}})}else{var d=$(s).find("li");if($(s)&&d.length>0)for(var l=0;l<d.length;l++)$(d[l]).hasClass("activeLine")&&(i=$(d[l]).attr("gid"));var c="/chat/quick/addquickReply.action";$.ajax({type:"post",url:c,data:{groupId:i,value:o,userId:a},dataType:"json",success:function(t){t.status&&($(e).parent(".js-detalBar").attr("qid",t.id),$(e).parent(".js-detalBar").attr("gid",i),g(!0))}})}}},C=function(){$(t).find(".js-delLeftGroup").removeClass("sureDel"),$(t).find(".js-delRightRep").removeClass("sureDel"),$(s).find(".js-delLeftGroup").text("删除").css("color","#38bfbe"),$(u).find(".js-delRightRep").text("删除").css("color","#38bfbe")},I=function(){T(),$(s).on("click","li",m),$(s).on("click",".js-delLeftGroup",y),$(s).on("click",".js-upLeftGroup",j),$(s).on("keypress","input",b),$(s).on("blur","input",x),$(s).on("focus","input",w),$(u).on("click","li",v),$(u).on("click",".js-delRightRep",y),$(u).on("click",".js-upRightRep",j),$(u).on("keypress","input",b),$(u).on("blur","input",x),$(u).on("focus","input",w),$(r).on("click",k),$(d).on("click",k),$(t).delegate(".js-content li","mouseleave",C)},B=function(){$(t).find(".js-content .js-leftContent .activeLine").length<=0?$(d).hide():$(d).show()},_=function(){h(),I(),g(),B()};_()};t.exports=i},{"./template.js":24,"./toTopAnimate.js":25}],23:[function(e,t,n){var i=function(t,n,i){function a(){c(h.shadowNode,n,i),h.dialog.show()}var o,s,u,r,d=n.getGlobal(),l=e("../../util/load.js")(),c=e("./fastLayer.js"),f=e("../../util/modal/dialog.js"),p=e("../../util/promise.js"),h={},g=function(){o=$(t).find(".js-panel-body .js-tab-pane#messagesuser .js-shortcut"),s=$(t).find(".js-rightQuickLeft ul"),u=$(t).find(".js-rightQuickRight ul"),r=$(".zc-shadow-layer .modal-dialog")},m=function(){var e=$(this).html();$(document.body).trigger("rightside.onSelectedByFastRelpy",[{data:e}])},v=function(){var e=$(this),t=$(u).find("li");$(t).removeClass("active");for(var n=0;n<t.length;n++)$(t[n]).attr("gid")==e.attr("gid")&&$(t[n]).addClass("active")},y=function(e){$(s).html(""),$(u).html(""),l.load(d.baseUrl+"views/rightside/fastreplyleft.html").then(function(t){var n=doT.template(t)({list:e});$(s).append(n)}),l.load(d.baseUrl+"views/rightside/fastreplyright.html").then(function(t){var n=doT.template(t)({list:e});$(u).append(n)})},j=function(){$.ajax({type:"post",cache:!1,data:{userId:i.id},url:"/chat/reply/replyGrouplist.action",dataType:"json",success:function(e){y(e)}})},b=function(e){var n=e||[];e||($(t).find(".js-rightQuickLeft ul").html(""),$(t).find(".js-rightQuickRight ul").html("")),l.load(d.baseUrl+"views/rightside/fastreplylayer.html").then(function(e){var t=doT.template(e)({list:n});h.dialog=new f({title:"快捷回复",footer:!1}),h.dialog.setInner(t),h.shadowNode=h.dialog.getOuter()})},x=function(){var e=new p,t="/chat/reply/replyGrouplist.action";return $.ajax({type:"post",cache:!1,data:{userId:i.id},url:t,dataType:"json",success:function(t){i.fastData=t,e.resolve(),b(t)}}).fail(function(t,n){"parsererror"===n&&(i.fastData=[],b(),e.resolve())}),e},w=function(){y(i.fastData)},T=function(){$(s).on("click","li",v),$(u).on("click","li",m),$(o).on("click",a),$(document.body).on("rightside.oReLoadRightGroup",j)},k=function(){g(),T(),w()};x().then(function(){k()})};t.exports=i},{"../../util/load.js":41,"../../util/modal/dialog.js":43,"../../util/promise.js":47,"./fastLayer.js":22}],24:[function(e,t,n){var i={},a='<li class="js-detalBar detalBar show activeLine"><input utype="{{=it.utype}}" type="text" class="newInput activeLine" maxlength={{=it.maxlength}} placeholder="请输入..." ><span class="{{=it.clsDelName}}">删除</span><span class="{{=it.clsUpName}}" >置顶</span></li>';i.zcReplyOuter=a,t.exports=i},{}],25:[function(e,t,n){function i(e,t,n){var i,a,o=e.find(".js-detalBar").length,s=t.index(),u=t.outerHeight(),r=300,d=function(){return 0!==t.index()},l=function(){a=e.find(".js-detalBar").eq(0),i=e.find(".js-detalBar").eq(s+1)},c=function(){a.animate({marginTop:u},r),t.animate({top:0},r,function(){t.insertBefore(a).find(".js-upLeftGroup").addClass("hide"),e.css({paddingBottom:0}),t.css({position:"",top:0}),i.css({marginTop:0}),a.css({marginTop:0}).find(".js-upLeftGroup").removeClass("hide"),n&&n()}),i.animate({marginTop:0},r)},f=function(){var n=t.position();t.css({position:"absolute",top:n.top}),i.css({marginTop:u}),s==o-1&&e.css({paddingBottom:u})},p=function(){if(!d())throw"the first node could not be top";l(),f(),c()};p()}t.exports=i},{}],26:[function(e,t,n){var i=!1,a=function(t,n,a){var o=n.getGlobal(),s=a,u={},r=[],d="",l=e("../../util/load.js")(),c=e("../../util/promise.js"),f=function(e,t){if(!e&&!t)return"-";var n=/^(https?)/;return e&&(e.match(n)||(e="http://"+e)),e&&!t?'<a target="_black"  class="js-aChat aChat" style="font-size:14px; color:#0d81c0;" href="'+e+'" title="'+e+'">'+e+"</a>":!e&&t?t:'<a target="_black" class="js-aChat aChat" style="font-size:14px;color:#0d81c0;" href="'+e+'" title="'+t+'">'+t+"</a>"},p=function(){var e=new c;return s&&($(t).html("").parents(".js-panel-body").removeClass("showBg"),$(t).html("").parents(".js-panel-body .js-tab-profilebg").addClass("hide"),l.load(o.baseUrl+"views/rightside/profileUser.html").then(function(n){s.userData.visit=f(s.userData.visitUrl,s.userData.visitTitle),"string"==typeof s.userData.params&&(s.userData.params=$.parseJSON($("<div>"+s.userData.params+"</div>").html()));var i=doT.template(n)({item:s});$(t).html(i),$(t).find("#sex").val(s.userData.sex),e.resolve()})),e},h=function(e,t){var n=$(t).attr("data-uid"),i="/chat/admin/modify_userinfo.action",a={},o=$(t).attr("otype"),s={};a.uid=n,a.sender=u.url_id,o&&(a[o]=e),$.ajax({type:"post",url:i,data:a,dataType:"json",success:function(i){$(t).val(e),s.status=!0,s.uid=n,$(t).hasClass("userNameDyy")?(s.name=e,s.update=1):(s.name="",s.update=0),$(document.body).trigger("rightside.onProfileUserInfo",[{data:s}])}})},g=function(){var e=$(this);if(e){var t=e.val().trim().replace(/[ ]/g,""),n=r[e.attr("otype")],i=!0,a=!1;if(d==t)a=!1;else for(var o=0;o<n.length;o++){var s=n[o];if(!s.regex.test(t)){i=!1,e.addClass("warm"),e.val(d);var u=e.siblings(".js-tip");u.find(".js-alerticon").text(s.alert);var l=e.offset().top-68,c=63;u.css({left:c+"px",top:l+"px"}).addClass("show").on("click",function(){$(this).removeClass("show"),e.removeClass("warm")});break}}i&&(e.siblings(".js-tip").removeClass("show").find(".js-alerticon").text(""),e.removeClass("warm"),a=!0),a&&h(t,e)}},m=function(){d=$(this).val(),$(this).select()},v=function(){var e=$(this).find("option:selected").val();h(e,$(this)[0])},y=function(){var e=$(".aChat");if(e.length>0){var t=$(".js-chatWarp").width(),n=$(".js-aChat").text($(".js-aChat").text())[0].offsetWidth;n>=t?$(".js-chatWarpi").addClass("show"):$(".js-chatWarpi").removeClass("show")}},j=function(){$(t).find("#dp").datepicker().on("changeDate",function(e){var t,n,i,a=e.date;t=a.getFullYear(),n=a.getMonth()+1<10?"0"+(Number(a.getMonth())+1):a.getMonth()+1,i=a.getDate()<10?"0"+a.getDate():a.getDate();var o=t+"-"+n+"-"+i;h(o,$(this)[0])})},b=function(){i||($(t).delegate(".js-userTnp","blur",g),$(t).delegate(".js-userTnp","focus",m),$(t).delegate(".js-sex","change",v),i=!0)},x=function(){y(),j()},w=function(){u.uid=s.data.uid,u.url_id=o.id,r={uname:[{regex:/\S/,alert:"格式错误，不允许为空"},{regex:/^[^<>\/\/]*$/,alert:"格式错误，请重新输入"},{regex:/^.{0,100}$/,alert:"最大输入100字符，请重新输入"}],realname:[{regex:/^[^<>\/\/]*$/,alert:"格式错误，请重新输入"},{regex:/^.{0,32}$/,alert:"最大输入32字符，请重新输入"}],tel:[{regex:/^[0-9\-#*]*$/,alert:"只允许数字、“#”、“*”、“-”"},{regex:/(^[0-9\-#*]{8,30}$)|(^[0-9\-#*]{0}$)/,alert:"输入8-30字符，请重新输入"}],birthday:[{regex:/^[1-2][0-9]{3}\-(([0-2]{1}[0-9]{1})|(3[0-1]{1}))(\-([0-2]{1}[0-9]{1})|(3[0-1]{1}))$/,alert:"只允许数字、“-”"}],email:[{regex:/^[^<>\/\/]*$/,alert:"只允许字母、数字或下划线"},{regex:/^([a-zA-Z0-9]+([-_\.][a-zA-Z0-9]+)*(?:@(?!-))(?:(?:[a-zA-Z0-9]*)(?:[a-zA-Z0-9](?!-))(?:\.(?!-)))+[a-zA-Z0-9]{2,})$/,alert:"格式错误，请重新输入"},{regex:/(^[-_\.a-zA-Z0-9]{1,16}(?:@(?!-))(?:(?:[a-zA-Z0-9]{0,10})(?:[a-zA-Z0-9](?!-))(?:\.(?!-))){1,2}[a-zA-Z0-9]{1,7}$)|(^[0-9]{0}$)/,alert:"最大输入40字符，请重新输入"}],qq:[{regex:/^[^<>\/\/]*$/,alert:"格式错误，请重新输入"},{regex:/(^[1-9][0-9]{4,29}$)|(^[0-9]{0}$)/,alert:"输入5-30位数字，请重新输入"}],weixin:[{regex:/^[^<>\/\/]*$/,alert:"格式错误，请重新输入"}],weibo:[{regex:/^[^<>\/\/]*$/,alert:"格式错误，请重新输入"},{regex:/(^.{4,24}$)|(^[0-9]{0}$)/,alert:"输入4-24位字符，请重新输入"}],remark:[{regex:/^[^<>\/\/]*$/,alert:"格式错误，请重新输入"},{regex:/^.{0,200}$/,alert:"最大输入200字符，请重新输入"}]}};p().then(function(){T()});var T=function(){w(),b(),x()}};t.exports=a},{"../../util/load.js":41,"../../util/promise.js":47}],27:[function(e,t,n){function i(t,n,i){var a,o,s=e("../util/load.js")(),u=e("../util/modal/dialog.js"),r=e("../util/modal/alert.js"),d=e("../util/qqFace.js"),l=e("../util/app.js"),c=e("./transfer.js"),f={},p={},h=!1,g="http://img.sobot.com/chatres/common/face/",m="http://img.sobot.com/console/common/face/",v=m+"robot.png",y={http:{chatList:{chat:"/chat/admin/get_chatdetail.action",hchat:"/chat/admin/get_chatdetail.action"},status:{black:{add:"/chat/admin/add_blacklist.action",del:"/chat/admin/delete_blacklist.action"},star:{add:"/chat/admin/add_marklist.action",del:"/chat/admin/delete_marklist.action"}},call:"/chat/admin/call.action",getOtherAdmin:"/chat/admin/getOhterAdminList.action",userTransfer:"/chat/admin/transfer.action",searchChat:"/chat/admin/internalChat1.action"},tpl:{chatList:"views/scrollcontent/list.html",chatItem:"views/scrollcontent/item.html",chatItemByAdmin:"views/scrollcontent/itemByAdmin.html",adminTable:"views/scrollcontent/adminTable.html",userReadySend:"views/scrollcontent/userReadySend.html",call:"views/scrollcontent/call.html",callTag:"views/scrollcontent/callTag.html",callDialog:"views/scrollcontent/callDialog.html"}},j=[g+"pcType.png",g+"weixinType.png",g+"appType.png",g+"weiboType.png",g+"moType.png",g+"moType.png"],b={},x=function(e){$body.trigger("scrollcontent.onSearchUserChat",[{uid:b.userId,str:e}])},w=function(e,t){$body.trigger("scrollcontent.onUpdateUserState",[{type:e,handleType:t,userId:b.userId}])},T=function(e,t,n){D(n),$body.trigger("scrollcontent.onTransfer",[{uid:n,userName:t}])},k=function(e,t,n,i,o,s,u,r,l){var c;if("function"==typeof arguments[0]&&(t=arguments[0],e="chat"),c=$.isArray(o)?o[0].uid:o.uid,f[c]&&f[c].list)n?$.ajax({url:y.http.chatList[e],dataType:"json",type:"post",data:{t:f[c].date||Date.parse(new Date),uid:c,pid:o.pid,pageNow:n||1,pageSize:i||20}}).success(function(t){var n=[],i=[];t.data.length>0?(t.data.map(function(e){n.push({action:"dateline",date:e.date}),e.content.map(function(e){e.msg=e.msg?d.analysis(e.msg):null,n.push(e)})}),i=n.concat(f[c].list),f[c].list=i,t.data[0]&&t.data[0].content[0]&&(f[c].date=t.data[0].content[0].t),s&&z(e,f[c],u,!0,r,n,!0)):z(e,f[c],u,!0,r,n,!0)}):s&&z(e,f[c],u,!1,r,l);else{a.find("#chat").show();var p=Date.now();a.find("#chat").find(".js-panel-body").addClass("hide"),a.find("#chat").find(".js-load-model").removeClass("hide"),f[c]||(f[c]={}),$.ajax({url:y.http.chatList[e],dataType:"json",type:"post",data:{t:f[c].date||Date.parse(new Date),uid:c,pid:o.pid,pageNow:n||1,pageSize:i||20}}).success(function(n){(Date.now()-p)/1e3;a.find("#chat").find(".js-panel-body").removeClass("hide"),a.find("#chat").find(".js-load-model").addClass("hide"),n.data[0]&&n.data[0].content[0]&&(f[c].date=n.data[0].content[0].t),t&&t(e,n,c,u)})}},F=function(){h?s.load(o.baseUrl+y.tpl.callDialog).then(function(e){var t,n=new u({title:"请结束上一个语音会话",footer:!1});t=doT.template(e)({}),n.setInner(t),n.show()}):$.ajax({url:y.http.call,dataType:"json",type:"post",data:{sender:b.sender,cid:b.cid,receiver:b.userId,called:f[b.userId].called}}).success(function(e){var t=[],n=(new Date).toLocaleString();f[b.userId].list.push({action:19,ts:n}),t.push({action:19,ts:n});var i=!0;k("chat",z,null,null,{uid:b.userId},i,!1,null,t),h=!0,f[b.userId].isCall=!1,a.find("#chat").find(".uesrDivNow").hide(),s.load(o.baseUrl+y.tpl.callTag).then(function(e){var t;t=doT.template(e)({data:{called:f[b.userId].called,uname:f[b.userId].uname}}),a.find("#chat").find(".uesrDivNow").hide(),$(document.body).find(".zc-c-call-tag").empty().append(t),$(document.body).find(".zc-c-call-tag").show()})})},C=function(e,t,n,i){var a=function(){$.ajax({url:y.http.status[e][t],dataType:"json",type:"post",data:{sender:b.sender,receiver:b.userId}}).success(function(i){n&&n(e,t)})};if("star"===e&&"add"===t)a();else{var o={star:{del:{title:"去除星标",content:"确定要取消标记这个用户吗？"}},black:{add:{title:"拉黑",content:"确定要拉黑这个用户吗？"},del:{title:"解除拉黑",content:"确定要取消拉黑这个用户吗？"}}},s=o[e][t],u=new r({title:s.title,text:s.content,OK:function(){i&&(i=!1,delete f[b.userId],a(),u.hide())}});u.show()}},I=function(e,t){new c(n,b,T)},B=function(e){$(e.getOuter()).find(".js-transfer-href").on("click",function(){var t=$(this).attr("uid"),n=$(this).attr("uname");$.ajax({url:y.http.userTransfer,dataType:"json",type:"post",data:{uid:b.sender,cid:b.cid,joinUid:t,userId:b.userId,userName:n}}).success(function(i){1===i.status&&e.hide(),T(t,n,b.userId)})})},_=function(){a.on("click",".fl .msg_content",function(){var e=$(this).html();-1===e.indexOf("http://img.sobot.com/yun/attachment/fileTypeImages/")&&(-1!==e.indexOf("webchat_img_upload")?i.open($(this).children("img").attr("src")):x(e))})},D=function(e,t,n){delete f[b.userId||e],a.find(".js-addButton").children(".js-goOut").addClass("hide"),a.find("#chat").find(".js-panel-body").empty(),n&&a.find("#chat").hide()},S=function(e,t,n,i){var u=Date.now();s.load(o.baseUrl+y.tpl.chatList).then(function(s){var r,c=[];if(t.data.map(function(e){c.push({action:"dateline",date:e.date}),e.content.map(function(e){e.msg=e.msg?d.analysis(e.msg):null,e.msg=e.msg?l.getUrlRegex(e.msg):null,c.push(e)})}),b.unreadcount){for(var p=0,h=c.length-1;h>-1;h--)if(5===c[h].action){if(p===b.unreadcount){c.splice(h+1,0,{action:"noReadLine"});break}p++}}else for(var h=0;h<c.length;h++)"noReadLine"===c[h].action&&c.splice(h,1);c.unshift({action:"loadmore"});var g=f[b.userId].isCall,m=f[b.userId].called,y=f[b.userId].uname,j=f[b.userId].date;f[n]={date:j,list:c,scrollTop:0,pageNo:1,isCall:g,called:m,uname:y},r=doT.template(s)({adminName:o.name,userSourceImage:b.userSourceImage,adminImage:o.face,systemImage:v,list:c}),a.find("#"+e).find(".js-panel-body").empty().html(r);(Date.now()-u)/1e3;setTimeout(function(){if(i){var t=a.find("#"+e).find(".js-panel-body").find(".webchat_img_upload").last()[0];if(t){var o=t.src;t.src=t.src+(o.indexOf("?")<0?"?":"&")+"r="+ +new Date,t.onload=function(){a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[n].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}}else a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[n].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}},400),f[b.userId].isCall?L():a.find("#chat").find(".uesrDivNow").hide()})},q=function(){a.find("#chat").find(".scrollBoxParent").scroll(function(){var e=$("#chat").find(".js-panel-body").height(),t=$("#chat").find(".scrollBoxParent").scrollTop();700>e-t&&a.find("#chat").find(".zc-newchat-tag").hide()})},z=function(e,t,n,i,u,r,c){c&&a.find(".js-zc-loadmore").empty(),r&&r.length>0?(r.map(function(e){e.msg=e.msg?d.analysis(e.msg):null}),s.load(o.baseUrl+y.tpl.chatItem).then(function(t){var i;if(c){for(var s=0;s<f[b.userId].list.length;s++)"loadmore"===f[b.userId].list[s].action&&f[b.userId].list.splice(s,1);r.unshift({action:"loadmore"}),f[b.userId].list.unshift({action:"loadmore"})}if(i=doT.template(t)({adminName:o.name,userSourceImage:b.userSourceImage,adminImage:o.face,systemImage:v,list:r}),c?a.find("#"+e).find(".js-panel-body").prepend(i):a.find("#"+e).find(".js-panel-body").append(i),n){var d=a.find("#"+e).find(".js-panel-body").find(".webchat_img_upload").last()[0];if(d){var l=d.src;d.src=d.src+(l.indexOf("?")<0?"?":"&")+"r="+ +new Date,d.onload=function(){a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[b.userId].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}}else a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[b.userId].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}else{var p=$("#"+e).find(".js-panel-body").height(),h=$("#"+e).find(".scrollBoxParent").scrollTop();if(p-h>700)103===u&&a.find("#"+e).find(".zc-newchat-tag").show();else{a.find("#"+e).find(".zc-newchat-tag").hide();var d=a.find("#"+e).find(".js-panel-body").find(".webchat_img_upload").last()[0];if(d){var l=d.src;d.src=d.src+(l.indexOf("?")<0?"?":"&")+"r="+ +new Date,d.onload=function(){a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[b.userId].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}}else a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[b.userId].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}}if($(".zc-c-chat-date-line-text").eq(1).length>0&&c){var g=$(".zc-c-chat-date-line-text").eq(1).parent().parent()[0].offsetTop;$("#"+e).find(".scrollBoxParent").scrollTop(g-180)}})):s.load(o.baseUrl+y.tpl.chatList).then(function(i){for(var s,u=0;u<t.list.length;u++)"noReadLine"===t.list[u].action&&t.list.splice(u,1);if(b.unreadcount)for(var p=0,u=t.list.length-1;u>-1;u--)if(5===t.list[u].action){if(p===b.unreadcount){t.list.splice(u+1,0,{action:"noReadLine"});break}p++}if(c)for(var u=0;u<t.list.length;u++)"loadmore"===t.list[u].action&&t.list.splice(u,1);if(t.list.map(function(e){e.msg=e.msg?d.analysis(e.msg):null,e.msg=e.msg?l.getUrlRegex(e.msg):null}),r&&t.list.unshift({action:"nomore"}),s=doT.template(i)({adminName:o.name,userSourceImage:b.userSourceImage,adminImage:o.face,systemImage:v,list:t.list}),a.find("#"+e).find(".js-panel-body").empty().html(s),f[b.userId].errorChatTokens&&f[b.userId].errorChatTokens.map(function(e){t.list.map(function(n){e===n.token&&a.find("#chat").find("").find('[data-token="'+t.token+'"]').show()})}),n){var h=a.find("#"+e).find(".js-panel-body").find(".webchat_img_upload").last()[0];if(h){var g=h.src;h.src=h.src+(g.indexOf("?")<0?"?":"&")+"r="+ +new Date,h.onload=function(){a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[b.userId].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}}else a.find("#"+e).find(".js-panel-body")[0].scrollIntoView(!1),f[b.userId].scrollBottom=a.find("#"+e).find(".js-panel-body").parent().scrollTop()}}),f[b.userId].isCall?L():a.find("#chat").find(".uesrDivNow").hide()},O=function(e,t){a.find(".js-addButton").children('[data-type="'+e+'"]').removeClass("hide"),a.find(".js-addButton").children(".js-"+e+"-"+t).addClass("hide"),w(e,t);var n=!!$("#chat").find(".js-panel-body").find("div").length;n&&P({type:e,handleType:t})},R=function(e){a.find(".js-addButton").children("a").addClass("hide");for(var t in e)"transfer"===t?e[t]&&a.find(".js-addButton").children(".js-transfer").removeClass("hide"):a.find(".js-addButton").children(".js-"+t+"-"+(e[t]?"del":"add")).removeClass("hide");a.find(".js-addButton").children(".js-transfer").removeClass("hide"),b.status||!b.from?a.find(".js-addButton").children(".js-transfer").addClass("hide"):a.find(".js-addButton").children(".js-transfer").removeClass("hide")},A={102:function(e){e.userHeadImage=j[e.source],e.t=new Date(e.t).toLocaleString().split(" ")[1]},103:function(e){e.userHeadImage=j[e.source],e.ts=e.ts.split(" ")[1]},108:function(e){e.t=new Date(e.t).toLocaleString().split(" ")[1]},111:function(e){}},L=function(){s.load(o.baseUrl+y.tpl.call).then(function(e){var t;t=doT.template(e)({data:{called:f[b.userId].called,uname:f[b.userId].uname,ts:(new Date).toTimeString().split(" ")[0]}}),a.find("#chat").find(".uesrDivNow").empty().append(t),a.find("#chat").find(".uesrDivNow").show()})},N=function(e){if(111===e.type)b.userId===e.uid&&s.load(o.baseUrl+y.tpl.userReadySend).then(function(t){var n;n=doT.template(t)({data:e}),a.find("#chat").find(".js-user-ready-input").show(),a.find("#chat").find(".js-user-ready-input").empty().append(n),setTimeout(function(){a.find("#chat").find(".js-user-ready-input").hide()},5e3)});else if(108===e.type){var t=[];if(b.userId===e.uid&&a.find(".js-transfer").addClass("hide"),f[e.uid]&&f[e.uid].list){f[e.uid].list.push({action:10,offlineType:5,receiverName:o.name,ts:"date "+new Date(e.t).toTimeString().split(" ")[0]}),t.push({action:10,offlineType:5,receiverName:o.name,ts:"date "+new Date(e.t).toTimeString().split(" ")[0]});var n=b.userId===e.uid;k("chat",z,null,null,e,n,!1,e.type,t)}}else if(112===e.type){var i=b.userId=e.uid,t=[];if(f[i]=f[i]||{},f[i].isCall=!0,f[i].called=e.called,f[i].uname=e.uname,f[e.uid]){var u=(new Date).toLocaleString();f[e.uid].list.push({action:18,ts:u}),t.push({action:18,ts:u});var n=b.userId===e.uid;k("chat",z,null,null,e,n,!1,e.type,t)}L()}else if(102===e.type)b.userId===e.uid&&a.find(".js-transfer").removeClass("hide"),e.isTransfer?delete f[e.uid]:f[e.uid]&&(delete f[e.uid],k("chat",S,null,null,{uid:b.userId,pid:b.pid},!0,!0));else{var t=[];if(f[e.uid]){103===e.type&&(f[e.uid].list=f[e.uid].list||[],f[e.uid].list.push({action:5,senderType:0,senderName:e.uname,msg:l.getUrlRegex(e.content),ts:e.ts}),t.push({action:5,senderType:0,senderName:e.uname,msg:l.getUrlRegex(e.content),ts:e.ts}));var n=b.userId===e.uid;k("chat",z,null,null,e,n,!1,e.type,t)}}},U=function(e){var t=e.length;A[e.type]&&A[e.type](e);for(var n=0;t>n;n++)N(e[n])},P=function(e,t){var n={star:{add:{action:16},del:{action:17}},black:{add:{action:11},del:{action:12}}},i=n[e.type][e.handleType],a=[];i.ts="date "+(new Date).toTimeString().split(" ")[0],i.senderName=o.name;var e={uid:b.userId,pid:b.pid};f[b.userId]=f[b.userId]||{list:[],scrollTop:0,pageNo:1},a.push(i),f[b.userId].list.push(i),k("chat",A,null,null,e,!0,!0,null,a)},G=function(e){var t=f[e.uid];if(t)if(t.errorChatTokens=t.errorChatTokens||[],"success"===e.type){var n=t.errorChatTokens.indexOf(e.token);-1!==n&&t.errorChatTokens.splice(n,1)}else e.uid===b.userId&&a.find("#chat").find('[data-token="'+e.token+'"]').show(),t.errorChatTokens.push(e.token)},M=function(e){var t=[];p[e.date]=e,f[e.uid]=f[e.uid]||{list:[],scrollTop:0,pageNo:1},f[e.uid].list.push({action:5,senderType:2,senderName:o.name,senderFace:o.face,msg:l.getUrlRegex(e.answer),ts:"date "+(new Date).toTimeString().split(" ")[0],token:e.date}),t.push({action:5,senderType:2,senderName:o.name,msg:l.getUrlRegex(e.answer),ts:"date "+(new Date).toTimeString().split(" ")[0],token:e.date});var n=b.userId===e.uid;k("chat",z,null,null,e,n,!0,null,t)},E=function(){$(document.body).find(".zc-c-call-tag").hide(),h=!1},H=function(){a=$(t),$body=$(document.body),q()},X=function(e,t){U(t),$("#chatSwitch").click(),setTimeout(function(){i.$("#inputMsg").val("tk最帅"),i.$("#sendBtn").click()},300)},Z=function(e,t){o=n.getGlobal(),W()},K=function(){$body.on("core.onload",Z),$body.on("core.receive",X),$(i||document.body).on("resize",function(){$(document.body).find(".zc-c-call-tag").width($(".rightBox").width())}),$body.on("core.sendresult",function(e){G(arguments[1])}),$body.on("textarea.send",function(e){M(arguments[1])}),$body.on("leftside.onhide",function(){D(arguments[1].uid,!0,!0)}),$body.on("leftside.cidchange",function(){var e=arguments[1];e.uid===b.userId&&(b.cid=e.cid)}),$body.on("leftside.onselected",function(){var e,t=arguments[1],n=a.find("#chat");e=t.data.face?t.data.face:j[t.data.usource|t.data.source],b={isStar:!!t.userData.ismark,isBlack:!!t.userData.isblack,isTransfer:!!t.userData.chatType,cid:t.data.cid,uid:o.id,pid:t.data.pid,sender:o.id,userId:t.data.uid,userSourceImage:e,from:"online"===t.data.from,unreadcount:t.unreadcount,status:"offline"===t.status},n.show(),n.find(".zc-newchat-tag , .js-user-ready-input").hide(),$(i).resize(),k("chat",S,null,null,{uid:t.data.uid,pid:t.data.pid},!0,!0),R({star:!!t.userData.ismark,black:!!t.userData.isblack,transfer:!!t.userData.chatType})}),$body.on("leftside.onremove",function(){D(arguments[1].uid)}),$body.on("rightside.onChatSmartReply",function(){var e={answer:arguments[1].data.msg,uid:b.userId,pid:b.pid};"1"===arguments[1].data.status&&M(e)}),a.find(".js-addButton").on("click",".js-goOut",function(e){var t=$(this),n=t.attr("data-type"),i=t.attr("data-handle"),a=!0;n||i?C(n,i,O,a):I(b.sender,B)}),a.find("#chat").on("click",".zc-c-chat-admin-ready-error",function(e){var t,n=$(e.target).attr("data-token");f[b.userId].list.map(function(e){e.token===parseInt(n)&&(t=e.msg)}),$(e.target).parents(".msg").remove(),$(document.body).trigger("textarea.send",[{
answer:t,uid:b.userId,cid:b.cid,date:Date.parse(new Date)}])}),a.find("#chat").on("click",".js-zc-loadmore",function(){var e={uid:b.userId,pid:b.pid};f[b.userId].pageNo++,k("chat",S,f[b.userId].pageNo,null,e,!0,!1)}),a.find("#chat").on("click",".zc-newchat-tag",function(){a.find("#chat").find(".js-panel-body")[0].scrollIntoView(!1),f[b.userId].scrollBottom=a.find("#chat").find(".js-panel-body").parent().scrollTop(),a.find("#chat").find(".zc-newchat-tag").hide()}),a.find("#chat").on("click",".callBtn",function(){F()}),$(document.body).on("click",".zc-c-call-tag-exit-btn",function(){E()}),_()},W=function(){s.load(o.baseUrl+y.tpl.chatItem)},V=function(){H(),K()};V()}t.exports=i},{"../util/app.js":34,"../util/load.js":41,"../util/modal/alert.js":42,"../util/modal/dialog.js":43,"../util/qqFace.js":48,"./transfer.js":28}],28:[function(e,t,n){function i(t,n,i){var a,o,s,u,r,d=e("../util/modal/dialog.js"),l=e("../util/modal/toast.js"),c=e("../util/promise.js"),f=this,p=!1,h=t.getGlobal(),g=e("../util/load.js")(),m=e("../util/date.js"),v='<li class="blank"><img src="img/static/loading.gif" /></li>',y=1,j="uname",b="";d.call(this,{title:"转接给新的客服",footer:!1,width:855});var x=[{name:"客服姓名",key:"uname"},{name:"客服昵称",key:"nickname"},{name:"接待状态",key:"count"},{name:"所属分组",key:"groupName"},{name:"操作",key:"operate",hiden:!0}],w=function(e){var t=e.currentTarget,n=$(t).attr("data-type"),i=$(t).attr("data-hiden");if("true"!==i){n!==j?(j=n,y=1):(y=(y+1)%2,0==y&&(y=2)),a.find(".sort").removeClass("up").removeClass("down");var o=$(t).find(".sort");o.addClass(1==y?"up":"down"),k()}},T=function(e){var t=($(this),a.find("input"));b=t.val(),k()},k=function(e,t){var t=t||new c;return o.html(v),window.localStorage&&(window.localStorage.sortKey=j,window.localStorage.sortType=y),$.ajax({url:"/chat/admin/getOhterAdminList.action",data:{uid:h.id,orderName:j,order:y,keyword:b},dataType:"json",type:"post"}).success(function(e){g.load(h.baseUrl+"views/scrollcontent/transferlist.html").then(function(t){s.text(m.formatTime(new Date));var n=doT.template(t)({list:e,keyword:b});o.html(n)})}).fail(function(e,t){}),t},F=function(e){13==e.keyCode&&(e.preventDefault(),b=a.find("input").val(),k())},C=function(e){var t=$(this);t.val().length>0?u.show():u.hide(),clearTimeout(r),r=setTimeout(function(){b=t.val(),k()},500)},I=function(){window.localStorage&&(y=window.localStorage.sortType||y,j=window.localStorage.sortKey||j)},B=function(){$(this).hide(),a.find("input").val(""),b="",k()},_=function(){a=$(f.getOuter()),s=a.find(".js-refresh-time"),o=a.find(".js-list-detail"),u=a.find(".js-clear-btn")},D=function(e){var a=e.currentTarget,o=$(a).attr("data-uname"),s=$(a).attr("data-uid");$(a).hasClass("disabled")||p||($(a).addClass("disabled").html("转接中..."),$.ajax({url:"/chat/admin/transfer.action",data:{uid:h.id,cid:n.cid,joinUid:s,userId:n.userId},dataType:"json",type:"POST"}).success(function(e){1==e.status?($(a).text("已转接").addClass("disabled"),p=!0,setTimeout(function(){f.hide()},500),i&&i(s,o,n.userId)):2==e.status?($(a).text("会话已结束"),new l(t,{icon:"alert",text:"会话已结束，无法转接"}),setTimeout(function(){f.hide()},2e3)):3==e.status&&$(a).text("客服已离线")}).fail(function(e){}))},S=function(){a.delegate(".js-transfer-btn","click",D),a.delegate(".js-column-key","click",w),a.find(".js-refresh-btn").on("click",k),a.find("input").on("input propertychange",C),a.find("input").on("keyup",F),u.on("click",B),a.find(".js-search-icon").on("click",T)},q=function(){g.load(h.baseUrl+"views/scrollcontent/transferouter.html").then(function(e,t){var n=doT.template(e)({columns:x,sortKey:j,sortType:y,dateStr:m.formatTime(new Date)});return f.setInner(n),f.show(),setTimeout(function(){t.resolve({})},0),_(),S(),a.find("input").focus(),t}).then(k),I()},z=function(){q()};z()}t.exports=i},{"../util/date.js":35,"../util/load.js":41,"../util/modal/dialog.js":43,"../util/modal/toast.js":45,"../util/promise.js":47}],29:[function(e,t,n){t.exports={".jpg":"image",".JPG":"image",".png":"image",".PNG":"image",".gif":"image",".GIF":"image",".txt":"txt",".TXT":"txt",".DOC":"doc",".doc":"doc",".docx":"doc",".DOCX":"doc",".pdf":"pdf",".PDF":"pdf",".ppt":"ppt",".PPT":"ppt",".PPTX":"ppt",".pptx":"ppt",".xls":"xls",".XLS":"xls",".xlsx":"xls",".XLSX":"xls",".RAR":"rar",".rar":"rar",".ZIP":"rar",".zip":"rar",".mp3":"player",".MP3":"player",".mp4":"player",".MP4":"player",".wma":"player",".WMA":"player",".WMV":"player",".wmv":"player",".rmvb":"player",".RMVB":"player"}},{}],30:[function(e,t,n){t.exports={txt:"http://img.sobot.com/yun/attachment/fileTypeImages/icon_txt.gif",doc:"http://img.sobot.com/yun/attachment/fileTypeImages/icon_doc.gif",pdf:"http://img.sobot.com/yun/attachment/fileTypeImages/icon_pdf.gif",ppt:"http://img.sobot.com/yun/attachment/fileTypeImages/icon_ppt.gif",xls:"http://img.sobot.com/yun/attachment/fileTypeImages/icon_xls.gif",rar:"http://img.sobot.com/yun/attachment/fileTypeImages/icon_rar.gif",player:"http://img.sobot.com/yun/attachment/fileTypeImages/icon_mp3.gif"}},{}],31:[function(e,t,n){function i(t,n,i){var a,o,s,u,r,d,l,c,o=n.getGlobal(),f=(e("../util/load.js")(),e("../util/qqFace.js")),p=e("./uploadImg.js"),h={},g=e("./template.js"),m=function(){u=$(t),r=u.find(".js-upload"),$sendMessage=u.find(".js-sendMessage"),$botTextBox=u.find(".js-botTextBox"),a=u.find("#faceGroupTarea")},v=function(e){var t=doT.template(g.listItem)(e),n=$(t);u.find(".js-users-list").append(n)},y=function(e,t){switch(t.type){case 102:v(t)}},j=function(e,t){l&&(h[l]=$sendMessage.val()),l=t.data.uid,d=t.data.cid,"online"==t.data.from?(x(l),$botTextBox.show(),$sendMessage.focus(),z()):"history"==t.data.from&&($botTextBox.hide(),z())},b=function(e,t){d=t},x=function(e){h[e]?$sendMessage.val(h[e]):$sendMessage.val("")},w=function(e,t){T(t),$(document.body).trigger("textarea.send",[{answer:c,uid:t.uid,cid:t.cid,date:+new Date}])},T=function(e){if(k(e)){u.find(".js-systeamTextBox"+e.date).remove();var t=$.extend({url:e.url,filename:e.filename,extension:e.extension,fileIcon:e.fileIcon});c=doT.template(g.tranfiletype)(t)}},k=function(e){switch(e.filetype){case"image":u.find(".js-systeamTextBox"+e.date).remove();var t=$.extend({url:e.url});return c=doT.template(g.fileImage)(t),!1;default:return!0}},F=function(e){var t=$sendMessage.val();return 0==t.length||/^\s+$/g.test(t)?($sendMessage.val(""),!1):($(document.body).trigger("textarea.send",[{answer:t,uid:l,cid:d,date:+new Date}]),void $sendMessage.val(""))},C=function(e,t){"2"==t.data.status&&$sendMessage.val(t.data.txt).focus()},I=function(e,t){$sendMessage.val(t.data).focus()},B=function(e){$sendMessage.val();return 13==e.keyCode?(F(),!1):void 0},_=function(e,t){var n=t.answer,i=document.getElementById("js-sendMessage"),a=-1;if(i.selectionStart||0==i.selectionStart)a=i.selectionStart;else{var o=document.selection.createRange();o.moveStart("character",-i.value.length),a=o.text.length}var s=$sendMessage.val().substring(0,a),u=$sendMessage.val().substring(a),r=s+n+u;$($sendMessage).val(r);var d=(s+n).length;if(i.setSelectionRange)i.setSelectionRange(d,d),i.focus();else if(i.createTextRange){var o=i.createTextRange();o.collapse(!0),o.moveEnd("character",d),o.moveStart("character",d),o.select()}},D=function(e,t){u.find("img.js-my-logo").attr("src",t.face),u.find(".js-customer-service").html(t.name),L()},S=function(){s.onChangeHandler(l,d)},q=function(e){for(var t=e.originalEvent,n=0,i=t.clipboardData.items.length;i>n;n++){var a=t.clipboardData.items[n];"file"===a.kind&&(e.preventDefault(),s.onFormDataPasteHandler(a,l,d))}},z=function(){var e=$botTextBox.height(),t=1;switch("block"==u.find(".js-botTextBox").css("display")&&(t=2),t){case 1:$(".scrollBoxParent").height($(i).height()-102+"px");break;case 2:$(".scrollBoxParent").height($(i).height()-(102+e)+"px")}$botTextBox.css("bottom","-232px")},O=function(e){""==$sendMessage.val()&&13!=e.keyCode&&$.ajax({url:"/chat/admin/input.action",data:{cid:d,uid:l},type:"post",dataType:"json"}).success(function(e){})},R=function(){$botTextBox.hide()},A=function(){$(document.body).on("core.onload",D),$(document.body).on("core.receive",y),$(document.body).on("leftside.onselected",j),$(document.body).on("leftside.oncidchange",b),$(document.body).on("textarea.uploadImgUrl",w),$(document.body).on("textarea.gotoxy",_),$(document.body).on("rightside.onSelectedByFastRelpy",I),$(document.body).on("rightside.onChatSmartReply",C),$(i||document.body).on("resize",z),u.find(".js-btnSend").on("click",F),$sendMessage.on("keydown",B),$sendMessage.on("paste",q),$sendMessage.on("keydown",O),u.find(".js-emotion").on("click",N),u.find(".icoLi").on("click",U),u.find(".js-upload").on("change",S)},L=function(){f.initConfig({saytext:".js-sendMessage",Group:"#faceGroupTarea",faceGroup:"#faceGroup",emojiGroup:"#emojiGroup",emotion:".js-emotion",path:o.scriptPath+"assets/images/qqarclist/",emojiPath:o.scriptPath+"assets/images/emoji/"},function(){})},N=function(){f.show(o),f.emojiShow(o),"block"==$(a).css("display")?$(this).addClass("select"):$(this).removeClass("select")},U=function(){$(this).addClass("active").siblings().removeClass("active"),u.find(".groupChildren").hide();var e=$(this).attr("data-tab");$(e).show()},P=function(){s=p(r,t,n,i),u.find(".item").perfectScrollbar(),R(),z()},G=function(){m(),A(),P()};G()}t.exports=i},{"../util/load.js":41,"../util/qqFace.js":48,"./template.js":32,"./uploadImg.js":33}],32:[function(e,t,n){var i={},a='<img src="{{=it.fileIcon}}" style="vertical-align: middle; margin-right: 2px;" class="uploadedFile"><a style="font-size:10px;" target="_blank" href="{{=it.url}}">{{=it.filename}}{{=it.extension}}</a>',o='<a href="{{=it.url}}" target="_blank"><img src="{{=it.url}}" class="webchat_img_upload upNowImg uploadedFile" /></a>',s='<div class="systeamTextBox systeamNowText js-systeamTextBox{{=it.date}}"><p class="systeamText">正在上传 {{=it.filename}}{{=it.extension}}</p></div>';i.tranfiletype=a,i.fileImage=o,i.uploading=s,t.exports=i},{}],33:[function(e,t,n){function i(t,n,i,a){var o={},s=i.getGlobal(),u=(e("../util/upload.js"),e("../util/modal/alert.js")),r=e("../util/modal/toast.js"),d=e("./fileType.json"),l=e("./fileTypeIcon.json"),c=e("./template.js"),f=function(){$node=$(n),$uploadBtn=$node.find(".js-upload")},p=function(e,t){m(e,t)},h=function(e){for(var t=e.substring(e.indexOf(":")+1,e.indexOf(";")),n=e.substring(e.indexOf(",")+1),i=atob(n),a=new Array(i.length),o=0;o<i.length;o++)a[o]=i.charCodeAt(o);var s=new Uint8Array(a),u=new Blob([s],{type:t});return u},g=function(e,t,n){var i=e.getAsFile();if(i&&"image/png"==i.type){var a=new FormData,o=new FileReader;o.onload=function(e){var i=e.target.result,o=h(i);a.append("file",o),a.append("type","paste"),a.append("pid",s.pid),a.append("countTag",1),a.append("source",0);var r="image",d="智齿科技",l=".png",c=new u({title:"您确定要上传这张图吗",text:'<img src="'+e.target.result+'">',OK:function(){v(t,n,a,l,d,r)}});c.show()},o.readAsDataURL(i)}},m=function(e,t){if(FormData){var n=new FormData,i=$uploadBtn[0],a="",o=$uploadBtn.val(),u=o.substr(o.lastIndexOf(".")),r=o.substring(o.lastIndexOf("\\")+1,o.lastIndexOf(".")),c=d[u],f=l[c];if(y(u,r)){for(var p=b(u,r),h=0;h<i.files.length;h++){var g=i.files[h];a+=g,n.append("file",g)}n.append("type","msg"),n.append("pid",s.pid),n.append("countTag",1),n.append("source",0),v(e,t,n,u,r,c,f,p)}$uploadBtn.val("")}else j(e,t)},v=function(e,t,n,i,a,o,s,u){$.ajax({url:"/chat/webchat/fileupload.action",type:"POST",data:n,dataType:"json",processData:!1,contentType:!1}).success(function(n){var r=n.url;$(document.body).trigger("textarea.uploadImgUrl",[{uid:e,cid:t,url:r,filetype:o,filename:a,extension:i,fileIcon:s,date:u}])}).fail(function(e){alert("上传失败")})},y=function(e,t){var n=/^(.jpg|.JPG|.png|.PNG|.gif|.GIF|.txt|.TXT|.DOC|.doc|.docx|.DOCX|.pdf|.PDF|.ppt|.PPT|.pptx|.PPTX|.xls|.XLS|.xlsx|.XLSX|.RAR|.rar|.zip|.ZIP|.mp3|.MP3|.mp4|.MP4|.wma|.WMA|.wmv|.WMV|.rmvb|.RMVB)$/;return n.test(e)?!0:(new r(i,{icon:"alert",text:"上传文件格式不正确"}),!1)},j=function(e,t){var n=$node.find(".js-fileinfo"),i=$uploadBtn.val(),a=i.substr(i.lastIndexOf(".")),o=i.substring(i.lastIndexOf("\\")+1,i.lastIndexOf(".")),s=d[a],u=l[s];if(y(a,o)){var r=b(a,o),c="iframe"+r;n.attr("target",c),n.attr("action","/chat/webchat/fileupload.action");var f=$('<iframe id="'+c+'" style="display:none;" name="'+c+'"></iframe>');f.on("load",function(){var n=f[0],i=n.contentWindow.document.body.getElementsByTagName("pre")[0],d=JSON.parse(i.innerHTML);$(document.body).trigger("textarea.uploadImgUrl",[{uid:e,cid:t,url:d.url,filetype:s,filename:o,extension:a,fileIcon:u,date:r}])}),$(document.body).append(f),n.submit()}$uploadBtn.val("")},b=function(e,t){var n=+new Date,i=$.extend({filename:t,extension:e,date:n}),a=doT.template(c.uploading)(i);return $node.find(".scrollBox").append(a),n},x=function(){},w=function(){f(),x()};return w(),o.onFormDataPasteHandler=g,o.onChangeHandler=p,o}t.exports=i},{"../util/modal/alert.js":42,"../util/modal/toast.js":45,"../util/upload.js":50,"./fileType.json":29,"./fileTypeIcon.json":30,"./template.js":32}],34:[function(e,t,n){var i={getUrlRegex:function(e){e=e.replace(/&amp;/g,"&"),e=e.replace(/&amp/g,"&");for(var t="",n=e.split(/\s+/),i=0;i<n.length;i++){var a=function(e){var t=/((https?|ftp|news):\/\/)?([a-zA-Z]([a-z0-9A-Z\-]*[\.])+([a-zA-Z]{2}|(aero|arpa|biz|com|coop|edu|gov|info|int|jobs|mil|museum|name|nato|net|org|pro|travel)(:[0-9]{1,4})?)|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(:[0-9]{1,4})?)(\/[a-zA-Z0-9_%=#\-\.~]+)*(\/([a-zA-Z0-9%=#_\-\.]*)(\?[a-zA-Z0-9+_\/\-\.#%=&]*)?)?(#[a-zA-Z][a-zA-Z0-9_]*)?$/;if(e.match(t)){var n=/^(https?):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?$/;e=e.match(n)?'<a href="'+e+'" target="_blank">'+e+"</a>":'<a href="http://'+e+'" target="_blank">'+e+"</a>"}return e+" "}(n[i]);t+=a}return t},linkAction:function(e,t){var n="";if(t)for(var i=0;i<t.length;i++)for(var a in t[i])n+=0===i?"?"+a+"="+t[i][a]:"&"+a+"="+t[i][a];e+=n,window.location.href=e}};t.exports=i},{}],35:[function(e,t,n){var i={},a=function(e){return e>=10?e+"":"0"+e},o=function(e){var t=a,n=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),s=[t(n),t(i),t(o)];return s.join(":")},s=function(e,t){var n=a,i=e.getFullYear(),s=e.getMonth()+1,u=e.getDate(),r=[n(i),n(s),n(u)],d=e.getHours(),l=e.getMinutes(),c=e.getSeconds();[n(d),n(l),n(c)];return r.join("-")+(t?"":" "+o(e))};i.formatTime=o,i.formatDate=s,t.exports=i},{}],36:[function(e,t,n){var i={},a=function(e){return e>=10?e+"":"0"+e},o=function(e){if(Object.prototype.toString.call(e).indexOf("Date")<0)throw"param error";var t=e.getHours(),n=e.getMinutes(),i=e.getSeconds(),o=[a(t),a(n),a(i)];return o.join(":")};i.getTime=o,t.exports=i},{}],37:[function(e,t,n){var i={};i.emojiTip=["u1F60A","u1F60B","u1F60C","u1F60D","u1F60E","u1F60F","u1F61A","u1F61C","u1F61D","u1F61E","u1F61F","u1F62A","u1F62B","u1F62C","u1F62D","u1F62E","u1F600","u1F601","u1F602","u1F603","u1F605","u1F606","u1F607","u1F608","u1F609","u1F611","u1F612","u1F613","u1F614","u1F615","u1F616","u1F618","u1F621","u1F622","u1F623","u1F624","u1F628","u1F629","u1F630","u1F631","u1F632","u1F633","u1F634","u1F635","u1F636","u1F637","u1F648","u1F649","u1F680","u2B50","u23F0","u23F3","u26A1","u26BD","u26C4","u26C5","u261D","u263A","u270A","u270B","u270C","u270F","u2600","u2601","u2614","u2615","u2744","u1F3A4","u1F3B2","u1F3B5","u1F3C0","u1F3C2","u1F3E1","u1F004","u1F4A1","u1F4A2","u1F4A3","u1F4A4","u1F4A9","u1F4AA","u1F4B0","u1F4DA","u1F4DE","u1F4E2","u1F6AB","u1F6BF","u1F30F","u1F33B","u1F35A","u1F36B","u1F37B","u1F44C","u1F44D","u1F44E","u1F44F","u1F46A","u1F46B","u1F47B","u1F47C","u1F47D","u1F47F","u1F48A","u1F48B","u1F48D","u1F52B","u1F64A","u1F64F","u1F319","u1F332","u1F339","u1F349","u1F356","u1F366","u1F377","u1F381","u1F382","u1F384","u1F389","u1F393","u1F434","u1F436","u1F437","u1F451","u1F484","u1F494","u1F525","u1F556"],i.emojiSymbolTip=["😊","😋","😌","😍","😎","😏","😚","😜","😝","😞","😟","😪","😫","😬","😭","😮","😀","😁","😂","😃","😅","😆","😇","😈","😉","😑","😒","😓","😔","😕","😖","😘","😡","😢","😣","😤","😨","😩","😰","😱","😲","😳","😴","😵","😶","😷","🙈","🙉","🚀","⭐","⏰","⏳","⚡","⚽","⛄","⛅","☝","☺","✊","✋","✌","✏","☀","☁","☔","☕","❄","🎤","🎲","🎵","🏀","🏂","🏡","🀄","💡","💢","💣","💤","💩","💪","💰","📚","📞","📢","🚫","🚿","🌏","🌻","🍚","🍫","🍻","👌","👍","👎","👏","👪","👫","👻","👼","👽","👿","💊","💋","💍","🔫","🙊","🙏","🌙","🌲","🌹","🍉","🍖","🍦","🍷","🎁","🎂","🎄","🎉","🎓","🐴","🐶","🐷","👑","💄","💔","🔥","🕖"],i.emojiReg=/(😊|😋|😌|😍|😎|😏|😚|😜|😝|😞|😟|😪|😫|😬|😭|😮|😀|😁|😂|😃|😅|😆|😇|😈|😉|😑|😒|😓|😔|😕|😖|😘|😡|😢|😣|😤|😨|😩|😰|😱|😲|😳|😴|😵|😶|😷|🙈|🙉|🚀|⭐|⏰|⏳|⚡|⚽|⛄|⛅|☝|☺|✊|✋|✌|✏|☀|☁|☔|☕|❄|🎤|🎲|🎵|🏀|🏂|🏡|🀄|💡|💢|💣|💤|💩|💪|💰|📚|📞|📢|🚫|🚿|🌏|🌻|🍚|🍫|🍻|���|👌|👍|👎|👏|👪|👫|👻|👼|👽|👿|💊|💋|💍|🔫|🙊|🙏|🌙|🌲|🌹|🍉|🍖|🍦|🍷|🎁|🎂|🎄|🎉|🎓|🐴|🐶|🐷|👑|💄|💔|🔥|🕖||||||||||||||||||||)/g,i.emojiReg2=/(😊|😋|😌|😍|😎|😏|😚|😜|😝|😞|😟|😪|😫|😬|😭|😮|😀|😁|😂|😃|😅|😆|😇|😈|😉|😑|😒|😓|😔|😕|😖|😘|😡|😢|😣|😤|😨|😩|😰|😱|😲|😳|😴|😵|😶|😷|🙈|🙉|🚀|⭐|⏰|⏳|⚡|⚽|⛄|⛅|☝|☺|✊|✋|✌|✏|☀|☁|☔|☕|❄|🎤|🎲|🎵|🏀|🏂|🏡|🀄|💡|💢|💣|💤|💩|💪|💰|📚|📞|📢|🚫|🚿|🌏|🌻|🍚|🍫|🍻|���|👌|👍|👎|👏|👪|👫|👻|👼|👽|👿|💊|💋|💍|🔫|🙊|🙏|🌙|🌲|🌹|🍉|🍖|🍦|🍷|🎁|🎂|🎄|🎉|🎓|🐴|🐶|🐷|👑|💄|💔|🔥|🕖||||||||||||||||||||)/,i.qqfaceReg=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/g,i.qqfaceReg2=/\/::\)|\/::~|\/::B|\/::\||\/:8-\)|\/::<|\/::\$|\/::X|\/::Z|\/::'\(|\/::-\||\/::@|\/::P|\/::D|\/::O|\/::\(|\/::\+|\/:–b|\/::Q|\/::T|\/:,@P|\/:,@-D|\/::d|\/:,@o|\/::g|\/:\|-\)|\/::!|\/::L|\/::>|\/::,@|\/:,@f|\/::-S|\/:\?|\/:,@x|\/:,@@|\/::8|\/:,@!|\/:!!!|\/:xx|\/:bye|\/:wipe|\/:dig|\/:handclap|\/:&-\(|\/:B-\)|\/:<@|\/:@>|\/::-O|\/:>-\||\/:P-\(|\/::'\||\/:X-\)|\/::\*|\/:@x|\/:8\*|\/:pd|\/:<W>|\/:beer|\/:basketb|\/:oo|\/:coffee|\/:eat|\/:pig|\/:rose|\/:fade|\/:showlove|\/:heart|\/:break|\/:cake|\/:li|\/:bome|\/:kn|\/:footb|\/:ladybug|\/:shit|\/:moon|\/:sun|\/:gift|\/:hug|\/:strong|\/:weak|\/:share|\/:v|\/:@\)|\/:jj|\/:@@|\/:bad|\/:lvu|\/:no|\/:ok|\/:love|\/:<L>|\/:jump|\/:shake|\/:<O>|\/:circle|\/:kotow|\/:turn|\/:skip|\/:oY|\/:#-0|\/:hiphot|\/:kiss|\/:<&|\/:&>|\/微笑|\/撇嘴|\/色|\/发呆|\/得意|\/流泪|\/害羞|\/闭嘴|\/睡|\/大哭|\/尴尬|\/发怒|\/调皮|\/呲牙|\/惊讶|\/难过|\/酷|\/冷汗|\/衰|\/骷髅|\/敲打|\/再见|\/擦汗|\/抠鼻|\/鼓掌|\/糗大了|\/坏笑|\/左哼哼|\/右哼哼|\/哈欠|\/鄙视|\/委屈|\/快哭了|\/阴险|\/亲亲|\/吓|\/可怜|\/抓狂|\/吐|\/偷笑|\/愉快|\/白眼|\/傲慢|\/饥饿|\/困|\/惊恐|\/流汗|\/憨笑|\/悠闲|\/奋斗|\/咒骂|\/疑问|\/嘘|\/晕|\/疯了|\/篮球|\/乒乓|\/咖啡|\/饭|\/猪头|\/玫瑰|\/调谢|\/嘴唇|\/爱心|\/心碎|\/蛋糕|\/闪电|\/炸弹|\/刀|\/足球|\/瓢虫|\/便便|\/月亮|\/太阳|\/礼物|\/拥抱|\/菜刀|\/西瓜|\/啤酒|\/弱|\/握手|\/胜利|\/抱拳|\/勾引|\/拳头|\/差劲|\/爱你|\/NO|\/OK|\/爱情|\/飞吻|\/跳跳|\/强|\/发抖|\/怄火|\/转圈|\/磕头|\/回头|\/跳绳|\/投降|\/激动|\/乱舞|\/献吻|\/左太极|\/右太极|\[微笑\]|\[撇嘴\]|\[色\]|\[发呆\]|\[得意\]|\[流泪\]|\[害羞\]|\[闭嘴\]|\[睡\]|\[大哭\]|\[尴尬\]|\[发怒\]|\[调皮\]|\[呲牙\]|\[惊讶\]|\[难过\]|\[酷\]|\[冷汗\]|\[衰\]|\[骷髅\]|\[敲打\]|\[再见\]|\[擦汗\]|\[抠鼻\]|\[鼓掌\]|\[糗大了\]|\[坏笑\]|\[左哼哼\]|\[右哼哼\]|\[哈欠\]|\[鄙视\]|\[委屈\]|\[快哭了\]|\[阴险\]|\[亲亲\]|\[吓\]|\[可怜\]|\[抓狂\]|\[吐\]|\[偷笑\]|\[愉快\]|\[白眼\]|\[傲慢\]|\[饥饿\]|\[困\]|\[惊恐\]|\[流汗\]|\[憨笑\]|\[悠闲\]|\[奋斗\]|\[咒骂\]|\[疑问\]|\[嘘\]|\[晕\]|\[疯了\]|\[篮球\]|\[乒乓\]|\[咖啡\]|\[饭\]|\[猪头\]|\[玫瑰\]|\[调谢\]|\[嘴唇\]|\[爱心\]|\[心碎\]|\[蛋糕\]|\[闪电\]|\[炸弹\]|\[刀\]|\[足球\]|\[瓢虫\]|\[便便\]|\[月亮\]|\[太阳\]|\[礼物\]|\[拥抱\]|\[菜刀\]|\[西瓜\]|\[啤酒\]|\[弱\]|\[握手\]|\[胜利\]|\[抱拳\]|\[勾引\]|\[拳头\]|\[差劲\]|\[爱你\]|\[NO\]|\[OK\]|\[爱情\]|\[飞吻\]|\[跳跳\]|\[强\]|\[发抖\]|\[怄火\]|\[转圈\]|\[磕头\]|\[回头\]|\[跳绳\]|\[投降\]|\[激动\]|\[乱舞\]|\[献吻\]|\[左太极\]|\[右太极\]/,t.exports=i},{}],38:[function(e,t,n){t.exports={"😊":"u1F60A.png","😋":"u1F60B.png","😌":"u1F60C.png","😍":"u1F60D.png","😎":"u1F60E.png","😏":"u1F60F.png","😚":"u1F61A.png","😜":"u1F61C.png","😝":"u1F61D.png","😞":"u1F61E.png","😟":"u1F61F.png","😪":"u1F62A.png","😫":"u1F62B.png","😬":"u1F62C.png","😭":"u1F62D.png","😮":"u1F62E.png","😀":"u1F600.png","😁":"u1F601.png","😂":"u1F602.png","😃":"u1F603.png","😅":"u1F605.png","😆":"u1F606.png","😇":"u1F607.png","😈":"u1F608.png","😉":"u1F609.png","😑":"u1F611.png","😒":"u1F612.png","😓":"u1F613.png","😔":"u1F614.png","😕":"u1F615.png","😖":"u1F616.png","😘":"u1F618.png","😡":"u1F621.png","😢":"u1F622.png","😣":"u1F623.png","😤":"u1F624.png","😨":"u1F628.png","😩":"u1F629.png","😰":"u1F630.png","😱":"u1F631.png","😲":"u1F632.png","😳":"u1F633.png","😴":"u1F634.png","😵":"u1F635.png","😶":"u1F636.png","😷":"u1F637.png","🙈":"u1F648.png","🙉":"u1F649.png","🚀":"u1F680.png","⭐":"u2B50.png","⏰":"u23F0.png","⏳":"u23F3.png","⚡":"u26A1.png","⚽":"u26BD.png","⛄":"u26C4.png","⛅":"u26C5.png","☝":"u261D.png","☺":"u263A.png","✊":"u270A.png","✋":"u270B.png","✌":"u270C.png","✏":"u270F.png","☀":"u2600.png","☁":"u2601.png","☔":"u2614.png","☕":"u2615.png","❄":"u2744.png","🎤":"u1F3A4.png","🎲":"u1F3B2.png","🎵":"u1F3B5.png","🏀":"u1F3C0.png","🏂":"u1F3C2.png","🏡":"u1F3E1.png","🀄":"u1F004.png","💡":"u1F4A1.png","💢":"u1F4A2.png","💣":"u1F4A3.png","💤":"u1F4A4.png","💩":"u1F4A9.png","💪":"u1F4AA.png","💰":"u1F4B0.png","📚":"u1F4DA.png","📞":"u1F4DE.png","📢":"u1F4E2.png","🚫":"u1F6AB.png","🚿":"u1F6BF.png","🌏":"u1F30F.png","🌻":"u1F33B.png","🍚":"u1F35A.png","🍫":"u1F36B.png","🍻":"u1F37B.png","👌":"u1F44C.png","👍":"u1F44D.png","👎":"u1F44E.png","👏":"u1F44F.png","👪":"u1F46A.png","👫":"u1F46B.png","👻":"u1F47B.png","👼":"u1F47C.png","👽":"u1F47D.png","👿":"u1F47F.png","💊":"u1F48A.png","💋":"u1F48B.png","💍":"u1F48D.png","🔫":"u1F52B.png","🙊":"u1F64A.png","🙏":"u1F64F.png","🌙":"u1F319.png","🌲":"u1F332.png","🌹":"u1F339.png","🍉":"u1F349.png","🍖":"u1F356.png","🍦":"u1F366.png","🍷":"u1F377.png","🎁":"u1F381.png","🎂":"u1F382.png","🎄":"u1F384.png","🎉":"u1F389.png","🎓":"u1F393.png","🐴":"u1F434.png","🐶":"u1F436.png","🐷":"u1F437.png","👑":"u1F451.png","💄":"u1F484.png","💔":"u1F494.png","🔥":"u1F525.png","🕖":"u1F556.png","":"u1F600.png","":"u1F637.png","":"u1F602.png","":"u1F61D.png","":"u1F635.png","":"u1F633.png","":"u1F631.png","":"u1F614.png","":"u1F609.png","":"u1F60C.png","":"u1F612.png","":"u1F47F.png","":"u1F47B.png","":"ue437.png","":"u1F64F.png","":"u1F4AA.png","":"u1F4B0.png","":"u1F382.png","":"u1F389.png","":"u1F381.png"}},{}],39:[function(e,t,n){t.exports={"[微笑]":"weixiao","[撇嘴]":"piezui","[色]":"se","[发呆]":"fadai","[得意]":"deyi","[流泪]":"liulei","[害羞]":"haixiu","[闭嘴]":"bizui","[睡]":"shui","[大哭]":"daku","[尴尬]":"ganga","[发怒]":"fanu","[调皮]":"tiaopi","[呲牙]":"ciya","[惊讶]":"jingya","[难过]":"nanguo","[酷]":"ku","[冷汗]":"lenghan","[衰]":"shuai","[骷髅]":"kulou","[敲打]":"qiaoda","[再见]":"zaijian","[擦汗]":"cahan","[抠鼻]":"koubi","[鼓掌]":"guzhang","[糗大了]":"qiudal","[坏笑]":"huaixiao","[左哼哼]":"zuohengheng","[右哼哼]":"youhengheng","[哈欠]":"haqian","[鄙视]":"bishi","[委屈]":"weiqu","[快哭了]":"kuaikul","[阴险]":"yinxian","[亲亲]":"qinqin","[吓]":"xia","[可怜]":"kelian","[抓狂]":"zhuakuang","[吐]":"tu","[偷笑]":"touxiao","[愉快]":"yukuai","[白眼]":"baiyan","[傲慢]":"aoman","[饥饿]":"jie","[困]":"kun","[惊恐]":"jingkong","[流汗]":"liuhan","[憨笑]":"hanxiao","[悠闲]":"youxian","[奋斗]":"fendou","[咒骂]":"zhouma","[疑问]":"yiwen","[嘘]":"xu","[晕]":"yun","[疯了]":"fengl","[篮球]":"lanqiu","[乒乓]":"pingpang","[咖啡]":"kafei","[饭]":"fan","[猪头]":"zhutou","[玫瑰]":"meigui","[调谢]":"diaoxie","[嘴唇]":"zuichun","[爱心]":"aixin","[心碎]":"xinsui","[蛋糕]":"dangao","[闪电]":"shandian","[炸弹]":"zhadan","[刀]":"dao","[足球]":"zuqiu","[瓢虫]":"piaochong","[便便]":"bianbian","[月亮]":"yueliang","[太阳]":"taiyang","[礼物]":"liwu","[拥抱]":"yongbao","[菜刀]":"caidao","[西瓜]":"xigua","[啤酒]":"pijiu","[弱]":"ruo","[握手]":"woshou","[胜利]":"shengli","[抱拳]":"baoquan","[勾引]":"gouyin","[拳头]":"quantou","[差劲]":"chajin","[爱你]":"aini","[NO]":"no_1","[OK]":"ok_1","[爱情]":"aiqing","[飞吻]":"feiwen","[跳跳]":"tiaotiao","[强]":"qiang","[发抖]":"fadou","[怄火]":"ouhuo","[转圈]":"zhuanquan","[磕头]":"ketou","[回头]":"huitou","[跳绳]":"tiaosheng","[投降]":"touxiang","[激动]":"jidong","[乱舞]":"luanwu","[献吻]":"xianwen","[左太极]":"zuotaiji","[右太极]":"youtaiji"}},{}],40:[function(e,t,n){t.exports={"/::)":"weixiao","/::~":"piezui","/::B":"se","/::|":"fadai","/:8-)":"deyi","/::<":"liulei","/::$":"haixiu","/::X":"bizui","/::Z":"shui","/::'(":"daku","/::-|":"ganga","/::@":"fanu","/::P":"tiaopi","/::D":"ciya","/::O":"jingya","/::(":"nanguo","/::+":"ku","/:–b":"lenghan","/:,@!":"shuai","/:!!!":"kulou","/::Q":"zhuakuang","/::T":"tu","/:,@P":"touxiao","/:,@-D":"yukuai","/::d":"baiyan","/:,@o":"aoman","/::g":"jie","/:|-)":"kun","/::!":"jingkong","/::L":"liuhan","/::>":"hanxiao","/::,@":"youxian","/:,@f":"fendou","/::-S":"zhouma","/:?":"yiwen","/:,@x":"xu","/:,@@":"yun","/::8":"fengl","/:xx":"qiaoda","/:bye":"zaijian","/:wipe":"cahan","/:dig":"koubi","/:handclap":"guzhang","/:&-(":"qiudal","/:B-)":"huaixiao","/:<@":"zuohengheng","/:@>":"youhengheng","/::-O":"haqian","/:>-|":"bishi","/:P-(":"weiqu","/:X-)":"yinxian","/::'|":"kuaikul","/::*":"qinqin","/:@x":"xia","/:8*":"kelian","/:pd":"caidao","/:<W>":"xigua","/:beer":"pijiu","/:basketb":"lanqiu","/:oo":"pingpang","/:coffee":"kafei","/:eat":"fan","/:pig":"zhutou","/:rose":"meigui","/:fade":"diaoxie","/:showlove":"zuichun","/:heart":"aixin","/:break":"xinsui","/:cake":"dangao","/:li":"shandian","/:bome":"zhadan","/:kn":"dao","/:footb":"zuqiu","/:ladybug":"piaochong","/:shit":"bianbian","/:moon":"yueliang","/:sun":"taiyang","/:gift":"liwu","/:hug":"yongbao","/:strong":"qiang","/:weak":"ruo","/:share":"woshou","/:v":"shengli","/:@)":"baoquan","/:jj":"gouyin","/:@@":"quantou","/:bad":"chajin","/:lvu":"aini","/:no":"no_1","/:ok":"ok_1","/:love":"aiqing","/:<L>":"feiwen","/:jump":"tiaotiao","/:shake":"fadou","/:<O>":"ouhuo","/:circle":"zhuanquan","/:kotow":"ketou","/:turn":"huitou","/:skip":"tiaosheng","/:oY":"touxiang","/:#-0":"jidong","/:hiphot":"luanwu","/:kiss":"xianwen","/:<&":"zuotaiji","/:&>":"youtaiji","/微笑":"weixiao","/撇嘴":"piezui","/色":"se","/发呆":"fadai","/得意":"deyi","/流泪":"liulei","/害羞":"haixiu","/闭嘴":"bizui","/睡":"shui","/大哭":"daku","/尴尬":"ganga","/发怒":"fanu","/调皮":"tiaopi","/呲牙":"ciya","/惊讶":"jingya","/难过":"nanguo","/酷":"ku","/冷汗":"lenghan","/衰":"shuai","/骷髅":"kulou","/敲打":"qiaoda","/再见":"zaijian","/擦汗":"cahan","/抠鼻":"koubi","/鼓掌":"guzhang","/糗大了":"qiudal","/坏笑":"huaixiao","/左哼哼":"zuohengheng","/右哼哼":"youhengheng","/哈欠":"haqian","/鄙视":"bishi","/委屈":"weiqu","/快哭了":"kuaikul","/阴险":"yinxian","/亲亲":"qinqin","/吓":"xia","/可怜":"kelian","/抓狂":"zhuakuang","/吐":"tu","/偷笑":"touxiao","/愉快":"yukuai","/白眼":"baiyan","/傲慢":"aoman","/饥饿":"jie","/困":"kun","/惊恐":"jingkong","/流汗":"liuhan","/憨笑":"hanxiao","/悠闲":"youxian","/奋斗":"fendou","/咒骂":"zhouma","/疑问":"yiwen","/嘘":"xu","/晕":"yun","/疯了":"fengl","/篮球":"lanqiu","/乒乓":"pingpang","/咖啡":"kafei","/饭":"fan","/猪头":"zhutou","/玫瑰":"meigui","/调谢":"diaoxie","/嘴唇":"zuichun","/爱心":"aixin","/心碎":"xinsui","/蛋糕":"dangao","/闪电":"shandian","/炸弹":"zhadan","/刀":"dao","/足球":"zuqiu","/瓢虫":"piaochong","/便便":"bianbian","/月亮":"yueliang","/太阳":"taiyang","/礼物":"liwu","/拥抱":"yongbao","/菜刀":"caidao","/西瓜":"xigua","/啤酒":"pijiu","/弱":"ruo","/握手":"woshou","/胜利":"shengli","/抱拳":"baoquan","/勾引":"gouyin","/拳头":"quantou","/差劲":"chajin","/爱你":"aini","/NO":"no_1","/OK":"ok_1","/爱情":"aiqing","/飞吻":"feiwen","/跳跳":"tiaotiao","/强":"qiang","/发抖":"fadou","/怄火":"ouhuo","/转圈":"zhuanquan","/磕头":"ketou","/回头":"huitou","/跳绳":"tiaosheng","/投降":"touxiang","/激动":"jidong","/乱舞":"luanwu","/献吻":"xianwen","/左太极":"zuotaiji","/右太极":"youtaiji","[微笑]":"weixiao","[撇嘴]":"piezui","[色]":"se","[发呆]":"fadai","[得意]":"deyi","[流泪]":"liulei","[害羞]":"haixiu","[闭嘴]":"bizui","[睡]":"shui","[大哭]":"daku","[尴尬]":"ganga","[发怒]":"fanu","[调皮]":"tiaopi","[呲牙]":"ciya","[惊讶]":"jingya","[难过]":"nanguo","[酷]":"ku","[冷汗]":"lenghan","[衰]":"shuai","[骷髅]":"kulou","[敲打]":"qiaoda","[再见]":"zaijian","[擦汗]":"cahan","[抠鼻]":"koubi","[鼓掌]":"guzhang","[糗大了]":"qiudal","[坏笑]":"huaixiao","[左哼哼]":"zuohengheng","[右哼哼]":"youhengheng","[哈欠]":"haqian","[鄙视]":"bishi","[委屈]":"weiqu","[快哭了]":"kuaikul","[阴险]":"yinxian","[亲亲]":"qinqin","[吓]":"xia","[可怜]":"kelian","[抓狂]":"zhuakuang","[吐]":"tu","[偷笑]":"touxiao","[愉快]":"yukuai","[白眼]":"baiyan","[傲慢]":"aoman","[饥饿]":"jie","[困]":"kun","[惊恐]":"jingkong","[流汗]":"liuhan","[憨笑]":"hanxiao","[悠闲]":"youxian","[奋斗]":"fendou","[咒骂]":"zhouma","[疑问]":"yiwen","[嘘]":"xu","[晕]":"yun","[疯了]":"fengl","[篮球]":"lanqiu","[乒乓]":"pingpang","[咖啡]":"kafei","[饭]":"fan","[猪头]":"zhutou","[玫瑰]":"meigui","[调谢]":"diaoxie","[嘴唇]":"zuichun","[爱心]":"aixin","[心碎]":"xinsui","[蛋糕]":"dangao","[闪电]":"shandian","[炸弹]":"zhadan","[刀]":"dao","[足球]":"zuqiu","[瓢虫]":"piaochong","[便便]":"bianbian","[月亮]":"yueliang","[太阳]":"taiyang","[礼物]":"liwu","[拥抱]":"yongbao","[菜刀]":"caidao","[西瓜]":"xigua","[啤酒]":"pijiu","[弱]":"ruo","[握手]":"woshou","[胜利]":"shengli","[抱拳]":"baoquan","[勾引]":"gouyin","[拳头]":"quantou","[差劲]":"chajin","[爱你]":"aini","[NO]":"no_1","[OK]":"ok_1","[爱情]":"aiqing","[飞吻]":"feiwen","[跳跳]":"tiaotiao","[强]":"qiang","[发抖]":"fadou","[怄火]":"ouhuo","[转圈]":"zhuanquan","[磕头]":"ketou","[回头]":"huitou","[跳绳]":"tiaosheng","[投降]":"touxiang","[激动]":"jidong","[乱舞]":"luanwu","[献吻]":"xianwen","[左太极]":"zuotaiji","[右太极]":"youtaiji"}},{}],41:[function(e,t,n){var i=e("./promise.js"),a={},o={},s=function(e,t){var t=t||new i;if(o[e])return i.when(function(){var t=o[e],n=new i;return setTimeout(function(){n.resolve(t)},0),n});var t=i.when(function(){return $.ajax({url:e,dataType:"text",type:"get"}).success(function(n){t.resolve(n),o[e]=n}).fail(function(e){t.reject(e)}),t});return t};a.load=s;var u=function(){return a};t.exports=u},{"./promise.js":47}],42:[function(e,t,n){function i(t){var n=e("./dialog"),i=this,a=$.extend({text:"TEXT",info:"",OK:function(e){}},t);n.call(this,a);var o=function(){var t=e("./template.js"),n=doT.template(t.zcAlertTemplate)(a);i.setInner(n)};o()}t.exports=i},{"./dialog":43,"./template.js":44}],43:[function(e,t,n){function i(t){var n,i,a=e("./template.js"),o=this,s=$.extend({okText:"确定",title:"提示",inner:!1,OK:function(){}},t),u=function(){n=$(a.zcShadowLayer);var e=doT.template(a.zcModalOuter)(s);i=$(e)},r=function(e){i.find(".modal-body").append($(e))},d=function(){n.find(".fade.in").animate({opacity:0},300,function(){setTimeout(function(){n.remove()},100)})},l=function(){n.on("click",d),i.on("click",function(e){e.stopPropagation()}),i.delegate(".bootbox-close-button","click",d),i.delegate(".js-cancel-btn","click",function(e){s.cancel&&s.cancel(o),
d()}),i.delegate(".js-ok-btn","click",function(e){d(),s.OK&&s.OK(o)})},c=function(){return i[0]},f=function(){l(),n.append(i),$(document.body).append(n),n.find(".fade.in").animate({opacity:1},300)},p=function(){u()};p(),this.getOuter=c,this.setInner=r,this.show=f,this.hide=d}t.exports=i},{"./template.js":44}],44:[function(e,t,n){var i={},a='<div class="zc-shadow-layer"></div>',o='<div class="bootbox  fade in" tabindex="-1" role="dialog" aria-hidden="false" style="display: block;outline:none;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="bootbox-close-button close" data-dismiss="modal" aria-hidden="true">×</button><h4 class="modal-title">{{=it.title || "提示"}}</h4></div><div class="modal-body"></div>{{ if((it.footer !== false) ) { }}<div class="modal-footer"><button class="btn btn-danger js-cancel-btn">{{=it.cancelText || "取消"}}</button><button class="btn btn-success js-ok-btn">{{=it.okText || "确定"}}</button></div>{{ } }}</div></div></div>',s='<div class="modal-alert-content"><p class="large">{{=it.text}}</p><p>{{=it.info}}</p></div>';i.zcAlertTemplate=s,i.zcModalOuter=o,i.zcShadowLayer=a,t.exports=i},{}],45:[function(e,t,n){function i(e,t){var n,i,a=e.getGlobal(),o=500,s=$.extend({icon:"alert",text:"（空）","":""},t),u={alert:a.scriptPath+"img/static/replyResendActive.png"},r=function(){var e=u[s.icon],t='<div class="zc-toast"><img src="'+e+'" /><span>'+s.text+'</span><button class="">×</button></div>';n=$(t);var a=$(window).outerWidth(),r=(a-o)/2;n.css({left:r>0?r:0}),$(document.body).append(n),n.find("button").on("click",function(){clearTimeout(i),d()})},d=function(){n.remove()};r(),i=setTimeout(d,2e3),this.show=r}t.exports=i},{}],46:[function(e,t,n){var i=0,a=1,o=2,s=3,u=4,r=function(e){var t=e.content||e.answer||"",n=/src=['"](.*?)['"]/;t.indexOf("<img")>=0?(t.indexOf("webchat_img_face")>=0?(e.message_type=i,e.desc=t):t.indexOf("webchat_img_upload")>=0?(e.message_type=a,e.desc="[图片]"):(t.indexOf("</")>=0||t.indexOf("/>")>=0)&&(e.message_type=u,e.desc="[富文本]"),n.test(t)&&(e.url=RegExp.$1)):t.indexOf("<audio")>=0?(e.message_type=s,e.desc="[语音]"):t.indexOf("</")>=0||t.indexOf("</")>=0?(e.message_type=u,e.desc="[富文本]"):(e.message_type=o,e.desc=t)};t.exports=r},{}],47:[function(e,t,n){function i(){var e=[];this.resolve=function(t){var n=e.shift();n&&n.success&&"function"==typeof n.success&&n.success(t,this)},this.reject=function(t){var n=e.shift();n&&n.fail&&"function"==typeof n.fail&&n.fail(t,this)},this.then=function(t,n){return e.push({success:t,fail:n}),this}}i.when=function(e){return e()},t.exports=i},{}],48:[function(e,t,n){var i=e("./load.js")(),a=e("./face/weixin.json"),o=e("./face/weixinsymbol.json"),s=(e("./unicode.js"),{initConfig:function(t,n){var i=this,s=t,u=e("./face/Reg.js");i.emojiImagePath=e("./face/emojiImagePath.json"),i.saytext=s.saytext||"",i.Group=s.Group||"",i.faceGroup=s.faceGroup||"",i.emojiGroup=s.emojiGroup||"",i.emotion=s.emotion||"",i.saytext=s.saytext||"",i.path=s.path||"",i.emojiPath=s.emojiPath||"",i.tip=a,i.tip2=o,i.emojiTip=u.emojiTip,i.emojiSymbolTip=u.emojiSymbolTip,i.qqfaceReg=u.qqfaceReg,i.qqfaceReg2=u.qqfaceReg2,i.emojiReg=u.emojiReg,i.emojiReg2=u.emojiReg2;for(var r in i.tip){var d=new Image;d.src=i.path+i.tip[r]+".gif"}},show:function(e){var t=this,n=t.faceGroup;$("#faceBox").length<=0&&i.load(e.baseUrl+"views/textarea/qqFace.html").then(function(e){var i=doT.template(e)({tip:t.tip,path:t.path});$(n).append(i)}),t.sendTotextArea(t.saytext)},emojiShow:function(e){var t=this;$("#emojiBox").length<=0&&i.load(e.baseUrl+"views/textarea/emoji.html").then(function(e){var n=doT.template(e)({emojiTip:t.emojiTip,emojiSymbolTip:t.emojiSymbolTip,emojiPath:t.emojiPath});$(emojiGroup).append(n)}),t.Hidden()},Hidden:function(){var e=this;"block"==$(e.Group).css("display")?$(e.Group).css("display","none"):$(e.Group).css("display","block"),$(e.saytext).focus(function(){$(e.Group).hide(),$(".js-emotion").removeClass("select")})},sendTotextArea:function(){var e=this;$(document.body).undelegate(),$(document.body).delegate(".faceIco","click",function(t){var n=t.currentTarget,i=$(n).attr("data-src");$(document.body).trigger("textarea.gotoxy",[{answer:i}]),$(e.Group).hide()})},analysis:function(e){var t=this;if(!e)return!1;var n=e.match(t.qqfaceReg);if(n)for(var i=0;i<n.length;i++){var a=t.qqfaceReg2.exec(e),o=t.tip2[a[0]];e=e.replace(t.qqfaceReg2,'<img style="width:24px;height:24px;" src="'+t.path+o+'.gif" border="0" />')}var s=e.match(t.emojiReg);if(s)for(var i=0,u=s.length;u>i;i++){var a=t.emojiReg2.exec(e),o=t.emojiImagePath[a[0]];e=e.replace(a[0],'<img style="width:24px;height:24px;" src="'+t.emojiPath+o+'" border="0" />')}return e},hasEmotion:function(e){return this.qqfaceReg.test(e)||this.emojiReg.test(e)}});t.exports=s},{"./face/Reg.js":37,"./face/emojiImagePath.json":38,"./face/weixin.json":39,"./face/weixinsymbol.json":40,"./load.js":41,"./unicode.js":49}],49:[function(e,t,n){var i={};i.parse=function(e){return e=e.replace(/\\/g,"%"),unescape(e)},i.stringify=function(e){for(var t=[],n=e.length,i=0;n>i;++i)t[i]=("00"+e.charCodeAt(i).toString(16)).slice(-4);return e?"\\u"+t.join("\\u"):""},t.exports=i},{}],50:[function(require,module,exports){function addEvent(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{if(!e.attachEvent)throw new Error("not supported or DOM not loaded");e.attachEvent("on"+t,function(){n.call(e)})}}function addResizeEvent(e){var t;addEvent(window,"resize",function(){t&&clearTimeout(t),t=setTimeout(e,100)})}function getBox(e){var t,n,i,a,o=getOffset(e);return t=o.left,i=o.top,n=t+e.offsetWidth,a=i+e.offsetHeight,{left:t,right:n,top:i,bottom:a}}function addStyles(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n])}function copyLayout(e,t){var n=getBox(e);addStyles(t,{position:"absolute",left:n.left+"px",top:n.top+"px",width:e.offsetWidth+"px",height:e.offsetHeight+"px"})}function fileFromPath(e){return e.replace(/.*(\/|\\)/,"")}function getExt(e){return-1!==e.indexOf(".")?e.replace(/.*[.]/,""):""}function hasClass(e,t){var n=new RegExp("\\b"+t+"\\b");return n.test(e.className)}function addClass(e,t){hasClass(e,t)||(e.className+=" "+t)}function removeClass(e,t){var n=new RegExp("\\b"+t+"\\b");e.className=e.className.replace(n,"")}function removeNode(e){e.parentNode.removeChild(e)}function placeholder(e){-1==navigator.userAgent.indexOf("WebKit")&&(e.onfocus=function(){$(e).attr("placeholder")==$(e).val()&&(e.value="")},e.onblur=function(){""==e.value&&(e.value=$(e).attr("placeholder"))})}if(document.documentElement.getBoundingClientRect)var getOffset=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,i=n.body,a=n.documentElement,o=a.clientTop||i.clientTop||0,s=a.clientLeft||i.clientLeft||0,u=1;if(i.getBoundingClientRect){var r=i.getBoundingClientRect();u=(r.right-r.left)/i.clientWidth}u>1&&(o=0,s=0);var d=t.top/u+(window.pageYOffset||a&&a.scrollTop/u||i.scrollTop/u)-o,l=t.left/u+(window.pageXOffset||a&&a.scrollLeft/u||i.scrollLeft/u)-s;return{top:d,left:l}};else var getOffset=function(e){var t=0,n=0;do t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent;while(e);return{left:n,top:t}};var toElement=function(){var e=document.createElement("div");return function(t){e.innerHTML=t;var n=e.firstChild;return e.removeChild(n)}}(),getUID=function(){var e=0;return function(){return"ValumsAjaxUpload"+e++}}(),AjaxUpload=function(e,t){this._settings={action:"upload.php",name:"userfile",multiple:!1,data:{},autoSubmit:!0,responseType:!1,hoverClass:"hover",focusClass:"focus",disabledClass:"disabled",onChange:function(e,t){},onSubmit:function(e,t){},onComplete:function(e,t){}};for(var n in t)t.hasOwnProperty(n)&&(this._settings[n]=t[n]);if(e.jquery?e=e[0]:"string"==typeof e&&(/^#.*/.test(e)&&(e=e.slice(1)),e=document.getElementById(e)),!e||1!==e.nodeType)throw new Error("Please make sure that you're passing a valid element");"A"==e.nodeName.toUpperCase()&&addEvent(e,"click",function(e){e&&e.preventDefault?e.preventDefault():window.event&&(window.event.returnValue=!1)}),this._button=e,this._input=null,this._disabled=!1,this.enable(),this._rerouteClicks()};AjaxUpload.prototype={setData:function(e){this._settings.data=e},disable:function(){addClass(this._button,this._settings.disabledClass),this._disabled=!0;var e=this._button.nodeName.toUpperCase();"INPUT"!=e&&"BUTTON"!=e||this._button.setAttribute("disabled","disabled"),this._input&&this._input.parentNode&&(this._input.parentNode.style.visibility="hidden")},enable:function(){removeClass(this._button,this._settings.disabledClass),this._button.removeAttribute("disabled"),this._disabled=!1},_createInput:function(){var e=this,t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("name",this._settings.name),this._settings.multiple&&t.setAttribute("multiple","multiple"),addStyles(t,{position:"absolute",right:0,margin:0,padding:"20px",fontFamily:"sans-serif",cursor:"pointer"});var n=document.createElement("div");if(addStyles(n,{display:"block",position:"absolute",overflow:"hidden",margin:0,padding:0,opacity:0,direction:"ltr",zIndex:2147483583}),"0"!==n.style.opacity){if("undefined"==typeof n.filters)throw new Error("Opacity not supported by the browser");n.style.filter="alpha(opacity=0)"}addEvent(t,"change",function(){if(t&&""!==t.value){var n=fileFromPath(t.value);return!1===e._settings.onChange.call(e,n,getExt(n))?void e._clearInput():void(e._settings.autoSubmit&&e.submit())}}),addEvent(t,"mouseover",function(){addClass(e._button,e._settings.hoverClass)}),addEvent(t,"mouseout",function(){removeClass(e._button,e._settings.hoverClass),removeClass(e._button,e._settings.focusClass),t.parentNode&&(t.parentNode.style.visibility="hidden")}),addEvent(t,"focus",function(){addClass(e._button,e._settings.focusClass)}),addEvent(t,"blur",function(){removeClass(e._button,e._settings.focusClass)}),n.appendChild(t),document.body.appendChild(n),this._input=t},_clearInput:function(){this._input&&(removeNode(this._input.parentNode),this._input=null,this._createInput(),removeClass(this._button,this._settings.hoverClass),removeClass(this._button,this._settings.focusClass))},_rerouteClicks:function(){var e=this;addEvent(e._button,"mouseover",function(){if(!e._disabled){e._input||e._createInput();var t=e._input.parentNode;copyLayout(e._button,t),t.style.visibility="visible"}})},_createIframe:function(){var e=getUID(),t=toElement('<iframe src="javascript:false;" name="'+e+'" />');return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t},_createForm:function(e){var t=this._settings,n=toElement('<form method="post" enctype="multipart/form-data"></form>');n.setAttribute("action",t.action),n.setAttribute("target",e.name),n.style.display="none",document.body.appendChild(n);for(var i in t.data)if(t.data.hasOwnProperty(i)){var a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",i),a.setAttribute("value",t.data[i]),n.appendChild(a)}return n},_getResponse:function(iframe,file){var toDeleteFlag=!1,self=this,settings=this._settings;addEvent(iframe,"load",function(){if("javascript:'%3Chtml%3E%3C/html%3E';"==iframe.src||"javascript:'<html></html>';"==iframe.src)return void(toDeleteFlag&&setTimeout(function(){removeNode(iframe)},0));var doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document;if(!(doc.readyState&&"complete"!=doc.readyState||doc.body&&"false"==doc.body.innerHTML)){var response;doc.XMLDocument?response=doc.XMLDocument:doc.body?(response=doc.body.innerHTML,settings.responseType&&"json"==settings.responseType.toLowerCase()&&(doc.body.firstChild&&"PRE"==doc.body.firstChild.nodeName.toUpperCase()&&(doc.normalize(),response=doc.body.firstChild.firstChild.nodeValue),response=response?eval("("+response+")"):{})):response=doc,settings.onComplete.call(self,file,response),toDeleteFlag=!0,iframe.src="javascript:'<html></html>';"}})},submit:function(){var e=this,t=this._settings;if(this._input&&""!==this._input.value){var n=fileFromPath(this._input.value);if(!1===t.onSubmit.call(this,n,getExt(n),this._input.files))return void this._clearInput();var i=this._createIframe(),a=this._createForm(i);removeNode(this._input.parentNode),removeClass(e._button,e._settings.hoverClass),removeClass(e._button,e._settings.focusClass),a.appendChild(this._input),a.submit(),removeNode(a),a=null,removeNode(this._input),this._input=null,this._getResponse(i,n),this._createInput()}}},module.exports=AjaxUpload},{}]},{},[9]);